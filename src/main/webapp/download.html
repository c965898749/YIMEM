<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>资源</title>
    <link rel="shortcut icon" href="img/favicon.ico">
    <script src="js/qrcode.min.js"></script>
    <script src="jquery/jquery.js"></script>
    <link rel="stylesheet" href="css/siderBar2.css">
    <link rel="stylesheet" type="text/css" href="css/css.css"/>
    <link rel="stylesheet" type="text/css" href="layui/css/layui.css" media="all"/>
    <script src="js/include.js"></script>
    <script src="js/download.js"></script>
    <script type="text/javascript" src="js/echarts.min.js"></script>
    <link rel="stylesheet" type="text/css" href="assets/waifu.min.css?v=1.4.2"/>
    <script src="assets/jquery.min.js?v=3.3.1"></script>
    <!-- 实现拖动效果，需引入 JQuery UI -->
    <script src="assets/jquery-ui.min.js?v=1.12.1"></script>
    <link rel="stylesheet" href="css/APlayer.min.css">
    <script src="js/APlayer.min.js"></script>
    <script src="js/setCookie.js"></script>
    <style>
        .aplayer-body{
            transition:all 0.5s ease-in;
            transform: translateX(-62px);
        }
        .aplayer-body:hover{
            transition:all 0.5s ease-in;
            transform: translateX(0px)
        }
        #down_load {
            border-bottom: 2px red solid;
        }


    </style>
</head>

<body>
<div id="titleContai">
    <include src="title.html"></include>
</div>
<div class="TOP">
    <div class="TOP-nav">
        <div id="home" style="cursor:pointer;">资源首页</div>
        <div id="myresources" style="cursor:pointer;">我的资源</div>
        <div id="upload" style="cursor:pointer;">上传资源赚积分</div>
    </div>
</div>
<div class="NAV">
    <div class="NAV-mian-left">
        <div class="classify">
            <div class="top">
                <div class="top-lef">
                    技术领域：
                </div>
                <div class="top-rig" id="top-rig">
                    <a href="">全部</a>

                </div>

            </div>
            <div class="cldtop-rig" id="cldtop-rig"
                 style="width: 880px;background-color: #F7F8F9;padding: 20px;box-sizing: border-box;margin-left: 6px"></div>
            <div class="foolt">
                <div class="foolt-left">
                    资源类型：
                </div>
                <div class="foolt-rig">
                    <a href="">全部</a>
                    <a href="javascript:void(0)">文档类</a>
                    <a href="javascript:void(0)">工具类</a>
                    <a href="javascript:void(0)">代码类</a>
                    <a href="javascript:void(0)">其他</a>
                </div>
            </div>
            <div class="snsearch">
                <div class="search-left">
                    关键词：
                </div>
                <input type="text" class="searchtext" name="search" value="">
                <input type="button" value="搜 索" class="searchbtn" onclick="searchbtn()">
            </div>
        </div>

        <div class="ad">

        </div>
        <div class="downloadlist" id="downloadlist">
            <div style="font-size: 16px;margin-left: 20px;height: 30px;line-height: 30px;">资源列表</div>

        </div>
        <div class="flooter">
            <div style="width:300px;margin:0 auto; padding:20px 0;">
                <img src="imgs/jh/jh.png" style="margin-left: 30px;margin-top: -15px" alt=""> <a target="_blank"
                                                                                                 href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32061202001097"
                                                                                                 style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img
                    src="" style="float:left;"/>
                <p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">苏公网安备
                    32061202001097号</p></a>
            </div>
        </div>
    </div>
    <div class="NAV-mian-right">
        <div class="ad">
            <img style="width: 300px;height: 200px" src="imgs/ad/blog/cd18.png"/>
        </div>
        <div class="upload" id="uploadIndex">

        </div>
        <div class="recommend">

        </div>
<!--        <div class="recommend">-->
<!--            <img src="imgs/ad/blog/cd17.png">-->
<!--        </div>-->
        <!--<img src="imgs/introduce/csdn.png">-->
        <div class="yimem_bz" style="background-color: white;margin-top: 10px;">
            <div style="width:300px;margin:0 auto">
                <img src="imgs/gz/gz.jpg" style="margin-top: 5px;margin-left: 30px;height: 100px;width: 100px" alt="">
                <img src="imgs/gz/eduwxfix.png" style="margin-top: 5px;margin-left: 30px;height: 100px;width: 100px"
                     alt="">
            </div>
            <div style="padding-bottom: 5px;margin: 0 auto;width: 250px ;border-bottom: 1px #E0E0E0 solid"><span style="color:#8B8B8B;margin-left: 15px">YIMEM公众号</span><span
                    style="color:#8B8B8B;margin-left: 60px">IT学院</span></div>
            <div style="padding-top: 5px;margin: 0 auto;width: 250px"><span style="color:#3D3D3D;font-weight: bold;margin-left: 20px">关于我们</span>
                <span
                        style="color:#3D3D3D;margin-left: 20px">网站地图</span><span
                        style="color:#3D3D3D;margin-left: 20px">广告服务</span></div>
            <div style="width:300px;margin:0 auto; padding:20px 0;">
<!--                <img src="imgs/jh/jh.png" style="margin-left: 30px;margin-top: -15px" alt=""> <a target="_blank"-->
<!--                                                                                                 href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32061202001097"-->
<!--                                                                                                 style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img-->
<!--                    src="" style="float:left;"/>-->
<!--                <p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">苏公网安备-->
<!--                    32061202001097号</p></a>-->
            </div>
        </div>
    </div>
</div>
<div class="NAV-myresouces">
    <div class="top-user" style="display:flex;padding: 10px">
        <div>
            <div class="top" id="top" style="width: 500px;">


            </div>
            <div class="count" id="count" style="width:500px ">

            </div>
        </div>

        <div class="top-rig">
            <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
            <div id="main" style="width: 500px;height:250px;"></div>
        </div>
    </div>
    <div class="NAV-myresouces-mian">
        <div class="main-lf">
            <div style="width: 890px;height: 42px;background-color:#EEF1F3;line-height: 42px;display: flex;">
                <div id="uploadcld"
                     style="font-size: 16px;color: red;background-color: white;padding-left: 20px;width: 120px;height: 42px;cursor: pointer;">
                    上传资源
                </div>
                <div id="integralcld"
                     style="font-size: 16px;color: red;padding-left: 20px;width: 120px;height: 42px; cursor: pointer;">
                    积分明细
                </div>
                <div id="downcld"
                     style="font-size: 16px;color: red;padding-left: 20px;width: 120px;height: 42px;cursor: pointer;">
                    资源明细
                </div>
                <div id="collentcld"
                     style="font-size: 16px;color: red;padding-left: 20px;width: 120px;height: 42px; cursor: pointer;">
                    我的收藏夹
                </div>
            </div>
            <div class="myintegrals">
                <div class="lists">
                    <table class="layui-table">
                        <colgroup>
                            <col width="180">
                            <col width="180">
                            <col width="180">
                        </colgroup>
                        <thead>
                        <tr>
                            <th>积分明细</th>
                            <th>记录时间</th>
                            <th>资源名称</th>
                        </tr>
                        </thead>
                        <tbody id="mixi">

                        </tbody>
                    </table>
                </div>

            </div>
            <div class="myresouces" id="myresouces">
                <div class="nav">
                    <div id="allupload" onclick="allupload()" style="cursor: pointer;">全部</div>
                    <div id="waitpassupload" onclick="waitpassupload()" style="cursor: pointer;">待审核</div>
                    <div id="passupload" onclick="passupload()" style="cursor: pointer;">已通过</div>
                    <div id="nopassupload" onclick="nopassupload()" style="cursor: pointer;">未通过</div>
                </div>
                <div class="lists" id="Invitation">


                </div>
                <div class="flooter">
                    <div style="width:300px;margin:0 auto; padding:20px 0;">
                        <img src="imgs/jh/jh.png" style="margin-left: 30px;margin-top: -15px" alt=""> <a target="_blank"
                                                                                                         href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32061202001097"
                                                                                                         style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img
                            src="" style="float:left;"/>
                        <p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">苏公网安备
                            32061202001097号</p></a>
                    </div>
                </div>
            </div>

        </div>
        <div class="main-rt">
            <div class="upload">
                <input type="button" value="上传资源" class="uploadbtn">
            </div>
            <div class="weichat">
                <div class="recommend">
                    <img src="imgs/ad/blog/cd17.png">
                </div>
                <!--<img src="imgs/introduce/csdn.png">-->
                <div class="yimem_bz" style="background-color: white;margin-top: 10px;">
                    <div style="width:300px;margin:0 auto">
                        <img src="imgs/gz/gz.jpg" style="margin-top: 5px;margin-left: 30px;height: 100px;width: 100px" alt="">
                        <img src="imgs/gz/eduwxfix.png" style="margin-top: 5px;margin-left: 30px;height: 100px;width: 100px"
                             alt="">
                    </div>
                    <div style="padding-bottom: 5px;margin: 0 auto;width: 250px ;border-bottom: 1px #E0E0E0 solid"><span style="color:#8B8B8B;margin-left: 15px">YIMEM公众号</span><span
                            style="color:#8B8B8B;margin-left: 60px">IT学院</span></div>
                    <div style="padding-top: 5px;margin: 0 auto;width: 250px"><span style="color:#3D3D3D;font-weight: bold;margin-left: 20px">关于我们</span>
                        <span
                                style="color:#3D3D3D;margin-left: 20px">网站地图</span><span
                                style="color:#3D3D3D;margin-left: 20px">广告服务</span></div>
                    <div style="width:300px;margin:0 auto; padding:20px 0;">
<!--                        <img src="imgs/jh/jh.png" style="margin-left: 30px;margin-top: -15px" alt=""> <a target="_blank"-->
<!--                                                                                                         href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32061202001097"-->
<!--                                                                                                         style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img-->
<!--                            src="" style="float:left;"/>-->
<!--                        <p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">苏公网安备-->
<!--                            32061202001097号</p></a>-->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="pageContainer" style="margin-left: 200px"></div>
</div>
<div class="NAV-upload">

    <div class="main">
        <span style="float: left;margin-top: -20px;display: inline-block;border-left: 3px red solid;font-size: 16px;color: #4a4a4a;font-weight: bold">上传资源</span>
        <input id="pic" type="file" style="opacity: 0;">
        <table id="chooseImage"
               style="cursor: pointer;margin-bottom: 20px;margin-left: 35px;margin-top: 10px;width: 1100px;height:100px;background-color: #F3F9FF"
               border="0" cellspacing="0" cellpadding="0" align="center">
            <tr>
                <td align="center" style="position: absolute" id="">
                    <div id="progressPersent" style="position: relative;left: 400px;top:30px">点击上传文件</div>
                </td>
            </tr>

            <tr>
                <td>
                    <!-- 红色部分 -->
                    <table width="0%" border="0" cellspacing="0" cellpadding="0" style="background-color: #9DD568"
                           id="progress">
                        <tr>
                            <td id="neirong" style="height: 99px"></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <form class="layui-form" action="" onSubmit="return false;" style="margin-left: 150px">
            <div>
                <input type="hidden" name="username">
            </div>
            <div>
                <input type="hidden" name="size">
            </div>
            <div>
                <input type="hidden" name="src">
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">资源名称</label>
                <div class="layui-input-block">
                    <input style="width: 520px" type="text" name="title" lay-verify="required" lay-reqtext="资源名称不能为空？"
                           placeholder="请输入资源名称" autocomplete="off" class="layui-input" maxlength="50">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">资源类型</label>
                <div class="layui-input-inline">
                    <select name="leixin" lay-verify="required">
                        <option value="">资源类型</option>
                        <option value="文档类" selected="">文档类</option>
                        <option value="代码类">代码类</option>
                        <option value="工具类">工具类</option>
                        <option value="其他">其他</option>
                    </select>
                </div>
                <label class="layui-form-label">设置金额</label>
                <div class="layui-input-inline">
                    <select name="price" lay-verify="required">
                        <option value="">金额值</option>
                        <option value="5" selected="">5积分</option>
                        <option value="2">2积分</option>
                        <option value="0">0积分</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">所属分类</label>
                <div class="layui-input-inline">
                    <select name="categoryid" lay-verify="required" id="category1" lay-filter="cate1">

                    </select>
                </div>
                <div class="layui-input-inline">
                    <select name="categoryid2" lay-verify="required" id="category2">

                    </select>
                </div>
                <div class="layui-input-inline">
                    <button class="layui-btn layui-btn-xs" style="margin-bottom: -9px; margin-left: -55px;" lay-filter="formDemo">会员私有</button>
                    <input type="checkbox" name="" title="公开"  lay-skin="primary" checked  disabled>
                </div>
            </div>

            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">资源描述</label>
                <div class="layui-input-block">
                            <textarea style="width: 520px" placeholder="请输入内容" name="intro" class="layui-textarea"
                                      lay-verify="required" maxlength="200"></textarea>
                </div>
            </div>

            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit="" lay-filter="createComment" id="csubmit"
                            style="background-color: red;color: white;">提交
                    </button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>
        </form>


    </div>
    <div class="flooter">
        <div style="width:300px;margin:0 auto; padding:20px 0;">
            <img src="imgs/jh/jh.png" style="margin-left: 30px;margin-top: -15px" alt=""> <a target="_blank"
                                                                                             href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32061202001097"
                                                                                             style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img
                src="" style="float:left;"/>
            <p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">苏公网安备
                32061202001097号</p></a>
        </div>
    </div>
</div>
<div class="siderBar">
    <ul>
        <li>返回</li>
        <li>顶部</li>
        <div>
            <div class="siderBar-line"></div>
            <div class="siderBar-goTop" id="btn"></div>
        </div>
    </ul>
</div>
<div id="aplayer"></div>
</body>
<script src="layui/layui.all.js"></script>
<script>

    //适配微信端的扫码
    function ma() {
        //初始化存放二维码的div
        var qrcode = new QRCode(document.getElementById("appma"), {
            width : 150,
            height : 150
        });
        //window.location.href获取到URL
        let url='http://www.yimem.com/Msg.html'
        if (url.indexOf('?') >0) {
            url+="&"+Math.random();
        } else {
            url+="?"+Math.random();
        }
        qrcode.makeCode(url);
        // qrcode.makeCode('https://www.baidu.com');
    }
    var navH = $(".recommend").offset().top;
    var page = 1;
    var pageSize = 4;
    var status = 1;
    var ppid = null;
    var title = null;
    var mokuai = 1;
    var categoryid = null;
    var categoryid2 = null;
    var leixin = null;
    var form, laypage;
    var colorpicker, upload, layer;
    var type = 0;
    //获取登入者ID
    var user = getUser();
    var userid = 0;
    if (user) {
        userid = user.userId
    }
    var a = 0;
    var b = 0;
    var c = 0;
    var d = 0;

    //引用表头
    // $("#titleContai").load("title.html")
    $(function () {
        resourceProp()
        $(".myintegrals").hide()
        taplan(getQueryString("type"))
        // $("header").load('title.html')
        ajaxGetInvitation(1, 4)
        getResources();
        getMenu();
        jinpin();
        $("#allupload").css("background-color", "red")
        $("#allupload").css("color", "white")
        $("#allupload").siblings().css("background-color", "")
        $("#allupload").siblings().css("color", "black")
        // 页面渲染
        if (userid == 0) {
            var html = ` <a href="login.html"><img src="imgs/btn/blog/_20190819134729.png" alt=""style="margin-left: -20px;margin-top: -20px"></a>`
            $("#uploadIndex").append(html)
        } else {
            var html = ` <div class="top">
                        <div class="top-lef"><a href="perInfor.html?viewUserId=` + userid + `&type=blog">
                        <img class="headimg" style="width: 48px;height: 48px;border-radius: 24px;"
                                 src="` + user.headImg + `"/>
                            </a>

                        </div>
                        <div class="top-rig">
                            <div class="username">
                                <a href="">` + user.username + `</a>
                            </div>
                            <div class="grade">
                                <div class="img">
                                    <img src="imgs/icons/blog/down1.png"/>
                                </div>
                                <div class=="context">
									<span style="color: #888;font-size: 12px;">
								资源积分：
							     </span>
                                    <span style="color: red;">` + user.downloadmoney + `</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="foolt">
                        <input type="button" value="上传资源" class="uploadbtn" onclick="uploadclick()">
                    </div>`;
            $("#uploadIndex").append(html)
        }
    });

    //获取占比
    function resourceProp() {
        $.ajax({
            url: "resourceProp"
            , type: "get"
            , dataType: "json"
            , success: function (jsonData) {
                ////////////////////////////console.log(jsonData)
                if (jsonData.success == 1) {
                    var data = jsonData.data;
                    bandin(data)
                }
            }
            , error: function (res) {
                ////////////////////////////console.log("ajax提交错误")
            }
        })
    }

    window.onscroll = function () {

        var scroH = $(this).scrollTop();
        if(scroH-600>=navH){
            $(".recommend").css({"position":"fixed","top":50});
            $(".yimem_bz").css({"position":"fixed","top":550});
        }else {
            $(".recommend").css({"position":"static"});
            $(".yimem_bz").css({"position":"static"});
        }

    }
    function bandin(data) {
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));

        // 指定图表的配置项和数据
        var app = {};
        option = null;
        option = {
            title: {
                text: '个人资源情况',
                subtext: '资源占比',
                left: 'center'
            },
            tooltip: {
                trigger: 'item',
                formatter: '{a} <br/>{b} : {c} ({d}%)'
            },
            // 文档类 工具类 代码类 其他
            legend: {
                orient: 'vertical',
                left: 'left',
                data: ['文档类', '工具类', '代码类', '其他类']
            },
            series: [
                {
                    name: '资源占比',
                    type: 'pie',
                    radius: '55%',
                    center: ['50%', '60%'],
                    data: (function () {
                        var res = [];
                        res.push({
                            name: '文档类',
                            value: data["文档类"]
                        })
                        res.push({
                            name: '工具类',
                            value: data["工具类"]
                        })
                        res.push({
                            name: '代码类',
                            value: data["代码类"]
                        })
                        res.push({
                            name: '其他类',
                            value: data["其他"]
                        })
                        return res;
                    })(),
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };
        ;
        if (option && typeof option === "object") {
            myChart.setOption(option, true);
        }
    }

    var timer = null;
    document.getElementById("btn").onclick = function () {
        cancelAnimationFrame(timer);
        timer = requestAnimationFrame(function fn() {
            var oTop = document.body.scrollTop || document.documentElement.scrollTop;
            if (oTop > 0) {
                scrollBy(0, -50);
                timer = requestAnimationFrame(fn);
            } else {
                cancelAnimationFrame(timer);
            }
        });
    }

    //精品渲染
    function jinpin() {
        $.ajax({
            url: "selecthot",
            type: "get",
            dataType: "json",
            success: function (json) {

                var html = ` <div class="top" style="display: flex;justify-content : space-between;">
                <div class="left">
                    <span style="font-size: 14px;color: #868B96">资源排行榜</span>
                </div>
                <!--<div class="right">-->
                    <!--<span style="color: #888;font-size: 14px;">-->
                    <!--<a href="blog_page.html" style="font-size: 14px;color: #868B96">更多</a>-->
                    <!--</span>-->
                <!--</div>-->
            </div>`;
                $(".recommend").html("")
                $(".recommend").append(html)
                $.each(json.data, function (index, eachobj) {
                    var html = `<div class="list">
                <div class="title" style="display: flex;white-space:normal;overflow: hidden;">
						<div style="width: 20px;height: 20px;background:${index<3?'#F25D8E':'#B8C0CC'};border-radius: 5px;text-align: center;color: white;font-weight: bolder;line-height: 20px;margin-right: 8px;">${index+1}</div>
                        <div style="width: 230px;"><a href="detailpage.html?id=${eachobj.id}" style="text-decoration : none">${eachobj.title}</a></div>
                </div>
                <div class="author" style="border-bottom: 1px #E6E6E6 solid;height: 30px;margin-top: 10px;">
                        <span style="color: #888;font-size: 14px;">
                         作者/分享人：<a style="text-decoration : none" href="perInfor.html?viewUserId=${eachobj.userid}&type=blog">${eachobj.user.nickname}</a> 资源数 ${eachobj.hot}
                          </span>
                </div>
             </div>`;
                    $(".recommend").append(html);
                    if (index > 4) {
                        return false;
                    }
                })

            },
            error: function (err) {

            }
        })
    }

    // 个人信息渲染
    $("#myresources").click(function () {
        $("#count").empty()
        $("#top").empty()
        window.history.pushState({status: 0}, '', '?type=2')
        taplan(2)

    })
    $("#home").click(function () {
        taplan(1)
        window.history.pushState({status: 0}, '', '?type=1')
    })

    $("#upload").click(function () {
        taplan(3)
        window.history.pushState({status: 0}, '', '?type=3')

    })

    function uploadclick() {
        taplan(3)
        window.history.pushState({status: 0}, '', '?type=3')
    }


    function taplan(type) {
        $("#cldtop-rig").hide()

        if (type == null) {
            $(".NAV-myresouces").hide();
            $(".NAV-upload").hide()
            $(".NAV").show()
            $("#home").css("border-bottom", "2px red solid")
            $("#myresources").css("border-bottom", "none")
            $("#upload").css("border-bottom", "none")
        } else {
            if (type == 1) {
                $(".NAV-myresouces").hide();
                $(".NAV-upload").hide()
                $(".NAV").show()
                $("#home").css("border-bottom", "2px red solid")
                $("#myresources").css("border-bottom", "none")
                $("#upload").css("border-bottom", "none")
            } else if (type == 2) {
                if (userid == 0) {
                    layer.open({
                        content: '你还未登录'
                        , btn: ['登录', '退出']
                        ,title:['提示']
                        , yes: function (index, layero) {
                            //按钮【按钮一】的回调
                            location.href = "login.html";
                            layer.close(index);
                        }
                        , btn2: function (index, layero) {
                            layer.close(index);
                        }
                    });
                    return false;
                } else {

                    $(".NAV-upload").hide()
                    $(".NAV-myresouces").show();
                    $(".NAV").hide()
                    $("#home").css("border-bottom", "none")
                    $("#myresources").css("border-bottom", "2px red solid")
                    $("#upload").css("border-bottom", "none")
                    people()
                }

            } else if (type == 3) {
                $(".NAV-upload").show();
                $(".NAV-myresouces").hide();
                $(".NAV").hide()
                $("#home").css("border-bottom", "none")
                $("#myresources").css("border-bottom", "none")
                $("#upload").css("border-bottom", "2px red solid")
            }
        }
    }

    // 上传组件

    /**

     * 侦查附件上传情况 ,这个方法大概0.05-0.1秒执行一次

     */

    function onprogress(evt) {

        // document.getElementById("progressBar").style.visibility="visible";
        var loaded = evt.loaded;       //已经上传大小情况

        var tot = evt.total;       //附件总大小

        var per = Math.floor(100 * loaded / tot);   //已经上传的百分比

        //document.getElementById("son").innerHTML =per +"%" ;
        if (per >= 99) {
            document.getElementById("progressPersent").innerText = "正在转码请稍等……(请不要刷新页面)";
            document.getElementById("progress").style.width = per + "%";
        } else {
            document.getElementById("progressPersent").innerText = per + "%";
            document.getElementById("progress").style.width = per + "%";
        }
    }

    //上传文件

    function uploadFile(Date) {

        var xhr = new XMLHttpRequest();
        //将上传的多个文件放入formData中

        var picFileList = document.getElementById("pic").files;
        //console.log(picFileList);
        if ($("#pic").val() == '') {
            layer.msg("上传文件不能为空")
            return false;
        }
        var formData = new FormData();

        formData.append("file", picFileList[0]);

        //监听事件

        xhr.upload.addEventListener("progress", onprogress, false);
        xhr.overrideMimeType('multipart/form-data; charset=utf-8');
        // xhr.addEventListener("error", uploadFailed, false);//发送文件和表单自定义参数

        xhr.open("POST", "resourceUpload", true);

        //记得加入上传数据formData

        xhr.send(formData);

        xhr.onreadystatechange = function () {
            //console.log( xhr)
            if (xhr.readyState == 4 && xhr.status == 200) {
                // 获取json数据
                var jsoncontent = JSON.parse(xhr.responseText)
                //////////console.log(jsoncontent)
                // if(xhr.responseText == "succes"){
                if (jsoncontent.success == 1) {
                    document.getElementById("progress").style.width = "100%";
                    document.getElementById("progressPersent").innerText = "100%";
                    Date.name = jsoncontent.data.original;
                    Date.src = jsoncontent.data.url;
                    Date.leixin2 = jsoncontent.data.type;
                    Date.size = jsoncontent.data.size;
                    //////////console.log(Date)
                    ajaxCreateComment(Date)
                } else {

                    document.getElementById("progressPersent").innerText = jsoncontent.errorMsg;

                }

            } else {
                document.getElementById("progressPersent").innerText = "服务器异常，请稍后上传！";
            }

        }

    }

    // 上传点击事件
    $("#chooseImage").click(function () {
        $("#pic").click();
    })

    $(".main").on("change", "input[type='file']", function () {
        // var filePath=$(this).val();
        var path = "imgs/filetype/zip .svg";
        var picFileList = document.getElementById("pic").files;
        ////////////console.log(picFileList[0].size)
        // if (picFileList[0].size > 23068672) {
        //     ////////////console.log("文件过大")
        //     $(this).val("")
        //     $("#progressPersent").text("文件过大,请重新上传")
        //     return false;
        // }
        ////////////console.log(picFileList[0])
        ////////////console.log( picFileList[0].type)
        var types = picFileList[0].name.split(".")
        ////////////console.log(types)
        var i = types.length
        ////////////console.log(i)
        var type = types[types.length - 1];
        ////////////console.log(name)
        if (picFileList[0].leixin2 == "zip") {
            path = "zip";
        } else if (picFileList[0].leixin2 == "pdf") {
            path = "pdf";
        } else if (picFileList[0].leixin2 == "rar") {
            path = "rar";
        } else if (picFileList[0].leixin2 == "exe") {
            path = "exe";
        } else if (picFileList[0].leixin2 == "docx") {
            path = "docx";
        } else if (picFileList[0].leixin2 == "doc") {
            path = "doc";
        } else if (picFileList[0].leixin2 == "ppt") {
            path = "ppt";
        } else if (picFileList[0].leixin2 == "txt") {
            path = "txt";
        } else if (picFileList[0].leixin2 == "xlsx") {
            path = "xlsx";
        } else if (picFileList[0].leixin2 == "7z") {
            path = "7z";
        } else if (picFileList[0].leixin2 == "gif") {
            path = "gif";
        } else if (picFileList[0].leixin2 == "gz") {
            path = "gz";
        } else if (picFileList[0].leixin2 == "html") {
            path = "html";
        } else if (picFileList[0].leixin2 == "jar") {
            path = "jar";
        } else if (picFileList[0].leixin2 == "mp4") {
            path = "mp4";
        } else if (picFileList[0].leixin2 == "png") {
            path = "png";
        } else if (picFileList[0].leixin2 == "pptx") {
            path = "pptx";
        } else if (picFileList[0].leixin2 == "swf") {
            path = "swf";
        } else if (picFileList[0].leixin2 == "apk") {
            path = "apk";
        } else {
            path = "unkonw";
        }
        $("#progressPersent").html(picFileList[0].name + "<img src='imgs/filetype/" + path + ".svg' style='width: 60px;height: 60px;'/>")
    })


    layui.use(['form', 'laypage'], function () {
        laypage = layui.laypage;
        form = layui.form;
        ////////////////console.log("表单、。。。。。。")
        // form表单提交   ---  onsubmit事件阻断方案
        //////////////////console.log(form.on)
        //此处去获取2级列表数据

        form.on('select(cate1)', function (data) {
            ////////////////console.log(data.elem); //得到select原始DOM对象
            ////////////////console.log(data.value); //得到被选中的值
            ////////////////console.log(data.othis); //得到美化后的DOM对象

            //此处去获取2级列表数据
            ////////////////console.log(data.value)
            ajaxGetCategory2(data.value);
        });

        form.on('submit(createComment)', function (data) {
            ////////////////console.log(data.elem) //被执行事件的元素DOM对象，一般为button对象
            ////////////////console.log(data.form) //被执行提交的form对象，一般在存在form标签时才会返回
            ////////////////console.log(data.field) //当前容器的全部表单字段，名值对形式：{name: value}
            //  先进行上传
            //  uploadFile(data.field)
            if (userid == 0) {
                layer.open({
                    content: '你还未登录'
                    , btn: ['登录', '退出']
                    , yes: function (index, layero) {
                        //按钮【按钮一】的回调
                        location.href = "login.html";
                        layer.close(index);
                    }
                    , btn2: function (index, layero) {
                        layer.close(index);
                    }
                });
                return false;
            }
            uploadFile(data.field);
            // ajaxCreateComment(data.field)


            return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
        });

    });

    function ajaxCreateComment(data) {
        var price = data.price;
        var name = data.name;
        // var userId = data.userid;
        var title = data.title;
        var intro = data.intro;
        var src = data.src;
        var leixin = data.leixin;
        var leixin2 = data.leixin2;
        var size = data.size;
        var categoryid = data.categoryid;
        var categoryid2 = data.categoryid2;
        ////////////////////////console.log(categoryid)
        ////////////////////////console.log(categoryid2)
        $.ajax({
            url: "saveUploadResource",
            data: {
                "name": name,
                "title": title,
                "intro": intro,
                "src": src,
                "leixin": leixin,
                "leixin2": leixin2,
                "categoryid": categoryid,
                "categoryid2": categoryid2,
                "size": size,
                "price": price
            },
            type: "POST",
            dataType: "json",
            success: function (jsonData) {

                var realFlag = jsonData.success;

                layer.msg(realFlag == 200 ? "上传成功" : "上传失败");
                if (realFlag == 200) {
                    setTimeout(function () {
                        location.href = "download.html?type=1";
                    }, 1 * 800)
                } else {
                    $("#pic").val("")
                }

            },
            error: function (xhr) {
                $("#pic").val("")
            }

        })
    }


    /// <summary>
    /// 格式化文件大小的JS方法
    /// </summary>
    /// <param name="filesize">文件的大小,传入的是一个bytes为单位的参数</param>
    /// <returns>格式化后的值</returns>
    function renderSize(filesize) {
        if (null == filesize || filesize == '') {
            return "0 Bytes";
        }
        var unitArr = new Array("Bytes", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB");
        var index = 0;
        var srcsize = parseFloat(filesize);
        index = Math.floor(Math.log(srcsize) / Math.log(1024));
        var size = srcsize / Math.pow(1024, index);
        size = size.toFixed(2);//保留的小数位数
        return size + unitArr[index];
    }

    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return r[2];
        return null;
    }

    // 渲染资源
    function getResources() {
        $("#downloadlist").empty();
        layui.use('flow', function () {
            var flow = layui.flow;

            flow.load({
                elem: '#downloadlist' //流加载容器
                , done: function (page, next) { //执行下一页的回调
                    var pageSize = 15;
                    //模拟数据插入
                    setTimeout(function () {
                        var lis = [];
                        $.ajax({
                            url: "findAllResources",
                            data: {
                                "leixin": leixin,
                                "categoryid": categoryid,
                                "categoryid2": categoryid2,
                                "title": title,
                                "page": page,
                                "pageSize": pageSize
                            },
                            type: "POST",
                            dataType: "json",
                            success: function (res) {
                                ////////////////console.log(res)
                                // var data=jsonData.data;
                                layui.each(res.data, function (index, item) {
                                    var path = "imgs/filetype/zip .svg";
                                    var daxiao = 0;
                                   //console.log(item.user.nickname)
                                    if (item.leixin2 == "zip") {
                                        path = "zip";
                                    } else if (item.leixin2 == "pdf") {
                                        path = "pdf";
                                    } else if (item.leixin2 == "rar") {
                                        path = "rar";
                                    } else if (item.leixin2 == "exe") {
                                        path = "exe";
                                    } else if (item.leixin2 == "docx") {
                                        path = "docx";
                                    } else if (item.leixin2 == "doc") {
                                        path = "doc";
                                    } else if (item.leixin2 == "ppt") {
                                        path = "ppt";
                                    } else if (item.leixin2 == "txt") {
                                        path = "txt";
                                    } else if (item.leixin2 == "xlsx") {
                                        path = "xlsx";
                                    } else if (item.leixin2 == "7z") {
                                        path = "7z";
                                    } else if (item.leixin2 == "gif") {
                                        path = "gif";
                                    } else if (item.leixin2 == "gz") {
                                        path = "gz";
                                    } else if (item.leixin2 == "html") {
                                        path = "html";
                                    } else if (item.leixin2 == "jar") {
                                        path = "jar";
                                    } else if (item.leixin2 == "mp4") {
                                        path = "mp4";
                                    } else if (item.leixin2 == "png") {
                                        path = "png";
                                    } else if (item.leixin2 == "pptx") {
                                        path = "pptx";
                                    } else if (item.leixin2 == "swf") {
                                        path = "swf";
                                    } else if (item.leixin2 == "apk") {
                                        path = "apk";
                                    } else {
                                        path = "unkonw";
                                    }
                                    var filesize = item.size;
                                    daxiao = renderSize(filesize);
                                    lis.push(`<div class="list"  data-id="` + item.id + `" data-leix="${item.leixin2}">
												<div class="img-left">
													<img src="imgs/filetype/` + path + `.svg" style="width: 42px;height: 48px;"/>
												</div>
												<a href="detailpage.html?id=` + item.id + `">
												<div class="context-model">
													<div class="title" id="title">
													` + item.title + `
														</div>
													<div class="main">
													` + item.intro + `
													</div>
													<div class="size">
														资源大小：` + daxiao + ` 上传时间：` + item.createtime + ` 上传者：` + item.user.nickname + `
													</div>
												</div>
												</a>
												<div class="img-right">
													<span style="color: #888;font-size: 14px;">
														积分/C币:
													</span> <span style="color: #ff9358;font-size: 32px;">
														` + item.price + `
													</span>
													<div><a class="goToPageB" target="_blank" href="detailpage.html?id=` + item.id + `">预览  <img style="width: 20px;height: 20px;" src="/imgs/btn/blog/yulang.png" alt="" ></a></div>
												</div>
											</div>`);
                                });
                                //执行下一页渲染，第二参数为：满足“加载更多”的条件，即后面仍有分页
                                //pages为Ajax返回的总页数，只有当前页小于总页数的情况下，才会继续出现加载更多
                                ////////////////console.log(res.count)
                                next(lis.join(''), page < res.count); //假设总页数为 10
                                // clik()
                                $('.goToPageB').on('click',function() {
                                    //console.log("点击");
                                    let leix = $(this).parents(".list").attr("data-leix");
                                    //console.log(leix);
                                    sessionStorage.setItem("from",leix);
                                })
                            },
                            error: function (xhr) {

                            }

                        })


                    }, 500);

                }
            });

            // function clik() {
            //     $("#downloadlist").on("click", ".title", function () {
            //         var id = $(this).parents(".list").attr("data-id");
            //        ////////////////////////////console.log(id)
            //         location.href = "detailpage.html?id=" + id;
            //     })
            // }
        });
    }


    // 渲染二级菜单
    function getMenu() {
        // //////console(aaaaa)
        $.ajax({
            url: "findAllCategory"
            , type: "get"
            , dataType: "json"
            , success: function (jsonData) {
               //console.log(jsonData)
                var data = jsonData.data;
                console.log(jsonData)
                // if (jsonData.success == 1) {
                //     data = jsonData.data;
                // }
                var html = '';
                var html2 = '<option value="">资源类型</option>';
                $.each(data, function (k, v) {
                    html = `<a href="javascript:void(0)"> <input class="feilei" type="hidden" value="` + v.id + `">` + v.categoryname + `</a>`;
                    html2 += ` <option value="` + v.id + `">` + v.categoryname + `</option>`;
                    $("#top-rig").append(html);

                })
                $("#category1").html(html2);
                form.render("select");
            }
            , error: function (res) {
                ////////////////////////////console.log("ajax提交错误")
            }
        })
    }

    function ajaxGetCategory2(pid) {
        // var data=getsecMenu(pid);
        $.ajax({
            url: "findCategoryByPid"
            , type: "GET"
            , data: {"pid": pid}
            , dataType: "json"
            // , async: false
            , success: function (jsonData) {
                ////////////////////////console.log(jsonData)
                var data = jsonData.data;
                var html = '<option value="">资源类型</option>';
                $.each(data, function (k, v) {
                    ////////////////////////console.log(v)
                    html += ` <option value="` + v.id + `">` + v.categoryname + `</option>`;

                });
                $("#category2").html(html);
                form.render("select");
            }
            , error: function (res) {
                ////////////////////////////console.log("ajax提交错误")
            }
        })

    }

    // 点击变色
    $("#top-rig").on("click", "a", function () {
        categoryid = $(this).find(".feilei").val()
        categoryid2 = null
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
        $("#cldtop-rig").show()
        //////////////////////////////console.log(category)
        getResources();
        ppid = categoryid
        zicaidan(ppid)
    })

    $("#cldtop-rig").on("click", "a", function () {
        categoryid = null
        categoryid2 = $(this).find(".feilei").val()
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
        //////////////////////////////console.log(category)
        getResources();
    })

    // 渲染子菜单
    function zicaidan(ppid) {
        if (ppid != null) {
            $.ajax({
                url: "findCategoryByPid"
                , type: "GET"
                , data: {"pid": ppid}
                , dataType: "json"
                // , async: false
                , success: function (jsonData) {
                    ////////////////////////console.log(jsonData)
                    var data = jsonData.data;
                    var html = '';
                    $.each(data, function (k, v) {
                        ////////////////////////console.log(v)
                        html += `<a href="javascript:void(0)" style="margin-left: 10px"> <input class="feilei" type="hidden" value="` + v.id + `">` + v.categoryname + `</a>`;
                    });
                    $("#cldtop-rig").html(html)

                }
                , error: function (res) {
                    ////////////////////////////console.log("ajax提交错误")
                }
            })
        }

    }

    // 类型分类
    $(".foolt-rig").on("click", "a", function () {
        value = $(this).text()
        if (value == "文档类") {
            leixin = "文档类"
        }
        if (value == "代码类") {
            leixin = "代码类"
        }
        if (value == "工具类") {
            leixin = "工具类"
        }
        if (value == "其他") {
            leixin = "其他"
        }
        //////////////////////////////console.log(leixin)
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
        getResources();
    })

    // 搜索
    function searchbtn() {
        title = $("input[name='search']").val()
        //////////////////////////console.log(title)
        getResources();
    }

    // vip
    function vipbtn() {
        ////////////////////////////console.log("vip")
        location.href = "vip.html"
    }

    // 用户详细

    //获取当前用户
    function getUser() {
        var data;
        $.ajax({
            url: "isEnter"
            , type: "get"
            , dataType: "json"
            , async: false
            , success: function (jsonData) {
                ////////////////////////////console.log(jsonData)
                if (jsonData.success == 1) {
                    data = jsonData.data;
                }
            }
            , error: function (res) {
                ////////////////////////////console.log("ajax提交错误")
            }
        })
        return data;
    }


    function people() {
        var html = `<div class="top-lefw"><a href="perInfor.html?viewUserId=` + userid + `&type=blog"> <img class="headimg" style="width: 98px;height: 98px;border-radius: 48px"
                         src="` + user.headImg + `"/></a>

                </div>
                <div class="top-model">
                    <div class="username">
                        <a href="" style="font-size: 16px;">` + user.username + `</a>
                    </div>
                    <div class="grade">
                        <div class="img">
                            <img src="imgs/icons/blog/down1.png"/>
                        </div>
                        <div class=="context">
					<span style="color: #888;font-size: 12px;">
				上传权限：
			     </span>
                            <span style="color:#888;">288M</span>
                        </div>
                    </div>
                </div>`;
        $("#top").append(html)
        var html2 = `<div class="integral">
                    <div class="top">
                        积分
                    </div>
                    <div class="foolt" style="margin-top: 10px;">
			<span style="color: #FF9358;font-size: 24px;text-align:center ;">
				` + user.downloadmoney + `
			</span>
                    </div>
                </div>
                <div class="integral">
                    <div class="top">
                        总排名

                    </div>
                    <div class="foolt" style="margin-top: 10px;">
			<span style="color: #FF9358;font-size: 24px;">
				0
			</span>
                    </div>
                </div>
                <div class="integral">
                    <div class="top">
                        上传资源
                    </div>
                    <div class="foolt" style="margin-top: 10px;">
			<span style="color: #FF9358;font-size: 24px;">
				` + user.resourceCount + `
			</span>
                    </div>
                </div>
                <div class="integral">
                    <div class="top">
                        资源资源
                    </div>
                    <div class="foolt" style="margin-top: 10px;">
			<span style="color: #FF9358;font-size: 24px;">
				` + user.downCount + `
			</span>
                    </div>
                </div>`
        $("#count").append(html2)

    }

    // function getQueryString(name) {
    //     var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
    //     var r = window.location.search.substr(1).match(reg);
    //     if (r != null) return r[2];
    //     return null;
    // }


    var page2 = 1;
    var pageSize2 = 4

    // 上传明细

    function allupload() {
        status = ""
        ajaxGetInvitation(1, 4)
    }

    function waitpassupload() {
        status = 2
        ajaxGetInvitation(1, 4)
    }

    function passupload() {
        status = 1
        ajaxGetInvitation(1, 4)
    }

    function nopassupload() {
        status = 4
        ajaxGetInvitation(1, 4)
    }

    $("#uploadcld").click(function () {
        $(".NAV-myresouces .NAV-myresouces-mian .main-lf .nav").show()
        mokuai = 1
        page2 = 1
        pageSize2 = 4
        ajaxGetInvitation(1, 4)
    })
    // 积分明细
    $("#integralcld").click(function () {
        mokuai = 2
        page2 = 1
        pageSize2 = 10
        integralcld(1, 10)
    })

    // 资源明细
    $("#downcld").click(function () {
        $(".NAV-myresouces .NAV-myresouces-mian .main-lf .nav").hide()
        mokuai = 3
        page2 = 1
        pageSize2 = 4
        downcld(1, 4)
    })

    // 收藏明细
    $("#collentcld").click(function () {
        $(".NAV-myresouces .NAV-myresouces-mian .main-lf .nav").hide()
        $("#myresouces").hide()
        mokuai = 4
        page2 = 1
        pageSize2 = 4
        Resocollect(1, 4)
    })

    // 分页
    function renderPager(totalCount, mokuai) {
        laypage.render({
            elem: 'pageContainer'
            , count: totalCount
            , limit: pageSize2
            , curr: page2
            , limits: [3, 5, 10, 20, 30, 40, 50]
            , layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
            , jump: function (obj, first) {
                //obj包含了当前分页的所有参数，比如：
                ////////////////////////console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
                ////////////////////////console.log(obj.limit); //得到每页显示的条数

                //首次不执行
                if (!first) {

                    //把分页值，和分页量（分页量可能会变化）
                    page2 = obj.curr;
                    pageSize2 = obj.limit;
                    if (mokuai == 1) {
                        ajaxGetInvitation(page2, pageSize2);
                    } else if (mokuai == 2) {
                        integralcld(page2, pageSize2)
                    } else if (mokuai == 3) {
                        downcld(page2, pageSize2)
                    } else if (mokuai = 4) {
                        Resocollect(page2, pageSize2)
                    }
                }
            }
        });

    }

    function ajaxGetInvitation(page2, pageSize2) {
        ////console.log(status)
        $.ajax({
            url: "findAllResourcess",
            data: {"page": page2, "pageSize": pageSize2, "status": status},
            type: "POST",
            dataType: "json",
            success: function (jsonData) {
                var item = jsonData.data;
                //////////console.log(jsonData)
                //////////////////////console.log(jsonData.count)

                var path = "imgs/filetype/zip.svg";
                var daxiao = 0;
                var filesize = 0
                ////////////////////////////console.log(item.leixin2)

                ////////////////console.log(filesize)
                ////////////////console.log(item)

                $("#Invitation").empty()
                $.each(item, function (i, v) {

                    if (v.leixin2 == "zip") {
                        path = "zip";
                    } else if (v.leixin2 == "pdf") {
                        path = "pdf";
                    } else if (v.leixin2 == "rar") {
                        path = "rar";
                    } else if (v.leixin2 == "exe") {
                        path = "exe";
                    } else if (v.leixin2 == "docx") {
                        path = "docx";
                    } else if (v.leixin2 == "doc") {
                        path = "doc";
                    } else if (v.leixin2 == "ppt") {
                        path = "ppt";
                    } else if (v.leixin2 == "txt") {
                        path = "txt";
                    } else if (v.leixin2 == "xlsx") {
                        path = "xlsx";
                    } else if (v.leixin2 == "7z") {
                        path = "7z";
                    } else if (v.leixin2 == "gif") {
                        path = "gif";
                    } else if (v.leixin2 == "gz") {
                        path = "gz";
                    } else if (v.leixin2 == "html") {
                        path = "html";
                    } else if (v.leixin2 == "jar") {
                        path = "jar";
                    } else if (v.leixin2 == "mp4") {
                        path = "mp4";
                    } else if (v.leixin2 == "png") {
                        path = "png";
                    } else if (v.leixin2 == "pptx") {
                        path = "pptx";
                    } else if (v.leixin2 == "swf") {
                        path = "swf";
                    } else if (v.leixin2 == "apk") {
                        path = "apk";
                    } else {
                        path = "unkonw";
                    }
                    filesize = v.size;
                    daxiao = renderSize(filesize);
                    var html = `<div class="list"  data-id="` + v.id + `">
                    <div class="img-left">
                        <img src="imgs/filetype/` + path + `.svg" style="width: 42px;height: 48px;"/>
                    </div>
                    <div class="context-model">
                        <div class="title" id="title">
                        <a href="detailpage.html?id=` + v.id + `">` + v.title + `</a>
                            </div>
                        <div class="main">
                        ` + v.intro + `
                        </div>
                        <div class="size">
                            资源大小：` + daxiao + ` 上传时间：` + v.createtime + ` 上传者：` + v.user.username + `
                        </div>
                    </div>
                    <div class="img-right">
                        <span style="color: #888;font-size: 14px;">
                            积分/C币:
                        </span> <span style="color: #ff9358;font-size: 32px;">
                            ` + v.price + `
                        </span>
                        <i class="layui-icon layui-icon-delete"></i>
                    </div>
                </div>`;
                    $("#Invitation").append(html);
                })
                $(".layui-icon-delete").click(function () {
                    var id = $(this).parents(".list").attr("data-id")
                    if (id!=null){
                        $.ajax({
                            url: "/upload/remove"
                            , type: "get"
                            , dataType: "json"
                            , data: {"id": id}
                            , success: function (jsonData) {
                                //////////////////console.log(jsonData)
                                layer.msg(jsonData.errorMsg);
                                ajaxGetInvitation(page2, pageSize2)
                                resourceProp()
                            }
                            , error: function (res) {
                                ////////////////////////////console.log("ajax提交错误")
                            }
                        })}
                })
                renderPager(jsonData.count, 1)
            },
            error: function (jsonData) {

            }
        })
    }


    function integralcld(page2, pageSize2) {
        $("#mixi").empty()
        $.ajax({
            url: "findIntegralsByUserid"
            , type: "get"
            , dataType: "json"
            , data: {"userid": userid, "page": page2, "pageSize": pageSize2}
            , success: function (jsonData) {
                //////////////////console.log(jsonData)
                var data = jsonData.data;
                var html = ""
                $("#mixi").append(html)
                $.each(data, function (k, v) {
                    html = ` <tr >
                                <td class="score">
                                   ` + v.price + `分
                                </td>
                                <td class="time">
                                    ` + v.createtime + `
                                </td>
                                <td class="title" id="tile">
                                    ` + v.title + `
                                </td>
                            </tr>`
                    $("#mixi").append(html)
                })
                renderPager(jsonData.count, 2)
            }
            , error: function (res) {
                ////////////////////////////console.log("ajax提交错误")
            }
        })
    }


    function downcld(page2, pageSize2) {
        $("#Invitation").empty()
        $.ajax({
            url: "downloadResourceMixi",
            data: {"page": page2, "pageSize": pageSize2, "userid": userid},
            type: "GET",
            dataType: "json",
            success: function (jsonData) {
                var item = jsonData.data;
                //////////console.log(item)
                //////////////////////console.log(item)
                //////////////////////console.log(jsonData.count)

                var path = "imgs/filetype/zip .svg";
                var daxiao = 0;
                ////////////////////////////console.log(item.leixin2)
                var filesize = 0
                $("#Invitation").empty()
                $.each(item, function (i, v) {

                    if (v.leixin2 == "zip") {
                        path = "zip";
                    } else if (v.leixin2 == "pdf") {
                        path = "pdf";
                    } else if (v.leixin2 == "rar") {
                        path = "rar";
                    } else if (v.leixin2 == "exe") {
                        path = "exe";
                    } else if (v.leixin2 == "docx") {
                        path = "docx";
                    } else if (v.leixin2 == "doc") {
                        path = "doc";
                    } else if (v.leixin2 == "ppt") {
                        path = "ppt";
                    } else if (v.leixin2 == "txt") {
                        path = "txt";
                    } else if (v.leixin2 == "xlsx") {
                        path = "xlsx";
                    } else if (v.leixin2 == "7z") {
                        path = "7z";
                    } else if (v.leixin2 == "gif") {
                        path = "gif";
                    } else if (v.leixin2 == "gz") {
                        path = "gz";
                    } else if (v.leixin2 == "html") {
                        path = "html";
                    } else if (v.leixin2 == "jar") {
                        path = "jar";
                    } else if (v.leixin2 == "mp4") {
                        path = "mp4";
                    } else if (v.leixin2 == "png") {
                        path = "png";
                    } else if (v.leixin2 == "pptx") {
                        path = "pptx";
                    } else if (v.leixin2 == "swf") {
                        path = "swf";
                    } else if (v.leixin2 == "apk") {
                        path = "apk";
                    } else {
                        path = "unkonw";
                    }
                    filesize = v.size;
                    ////////////////console.log(v)
                    ////////////////console.log(filesize)
                    daxiao = renderSize(filesize);
                    var html = `<div class="list"  data-id="` + v.id + `">
                    <div class="img-left">
                        <img src="imgs/filetype/` + path + `.svg" style="width: 42px;height: 48px;"/>
                    </div>
                    <div class="context-model">
                        <div class="title" id="title">
                        <a href="detailpage.html?id=` + v.dowid + `">` + v.title + `</a>
                            </div>
                        <div class="size">
                            资源大小：` + daxiao + ` 资源时间：` + v.createtime + `
                        </div>
                    </div>
                    <div class="img-right">
                        <span style="color: #888;font-size: 14px;">
                            积分/C币:
                        </span> <span style="color: #ff9358;font-size: 32px;">
                            ` + v.price + `
                        </span>
                    </div>
                </div>`;
                    $("#Invitation").append(html);
                })
                renderPager(jsonData.count, 3)
            },
            error: function (jsonData) {

            }
        })
    }


    // 收藏明细
    function Resocollect(page2, pageSize2) {
        $("#Invitation").empty()
        $.ajax({
            url: "selectAllResocollectBypage",
            data: {"page": page2, "pageSize": pageSize2, "userid": userid},
            type: "GET",
            dataType: "json",
            success: function (jsonData) {
                var item = jsonData.data;
                ////////console.log(item)
                //////////////////////console.log(item)
                //////////////////////console.log(jsonData.count)

                var path = "imgs/filetype/zip .svg";
                var daxiao = 0;
                ////////////////////////////console.log(item.leixin2)
                var filesize = 0
                $("#Invitation").empty()
                $.each(item, function (i, v) {

                    if (v.leixin2 == "zip") {
                        path = "zip";
                    } else if (v.leixin2 == "pdf") {
                        path = "pdf";
                    } else if (v.leixin2 == "rar") {
                        path = "rar";
                    } else if (v.leixin2 == "exe") {
                        path = "exe";
                    } else if (v.leixin2 == "docx") {
                        path = "docx";
                    } else if (v.leixin2 == "doc") {
                        path = "doc";
                    } else if (v.leixin2 == "ppt") {
                        path = "ppt";
                    } else if (v.leixin2 == "txt") {
                        path = "txt";
                    } else if (v.leixin2 == "xlsx") {
                        path = "xlsx";
                    } else if (v.leixin2 == "7z") {
                        path = "7z";
                    } else if (v.leixin2 == "gif") {
                        path = "gif";
                    } else if (v.leixin2 == "gz") {
                        path = "gz";
                    } else if (v.leixin2 == "html") {
                        path = "html";
                    } else if (v.leixin2 == "jar") {
                        path = "jar";
                    } else if (v.leixin2 == "mp4") {
                        path = "mp4";
                    } else if (v.leixin2 == "png") {
                        path = "png";
                    } else if (v.leixin2 == "pptx") {
                        path = "pptx";
                    } else if (v.leixin2 == "swf") {
                        path = "swf";
                    } else if (v.leixin2 == "apk") {
                        path = "apk";
                    } else {
                        path = "unkonw";
                    }
                    filesize = v.size;
                    //////////console.log(v)
                    ////////////////console.log(filesize)
                    daxiao = renderSize(filesize);
                    var html = `<div class="list"  data-id="` + v.id + `">
                    <div class="img-left">
                        <img src="imgs/filetype/` + path + `.svg" style="width: 42px;height: 48px;"/>
                    </div>
                    <div class="context-model">
                        <div class="title" id="title">
                        <a href="detailpage.html?id=` + v.dowid + `">` + v.title + `</a>
                            </div>
                        <div class="size">
                            资源大小：` + daxiao + ` 资源时间：` + v.createtime + `
                        </div>
                    </div>
                    <div class="img-right">
                    <div class="ResocollectBt"   data-dowid="` + v.dowid + `">取消收藏</div>
                        </span>
                    </div>
                </div>`;
                    $("#Invitation").append(html);
                })
                $(".ResocollectBt").click(function () {
                    var tt = $(this)
                    var dowid = $(this).attr('data-dowid');
                    layer.open({
                        content: '确定取消收藏'
                        , btn: ['确定', '退出']
                        ,title:['收藏']
                        , yes: function (index, layero) {
                            $.ajax({
                                url: "saveResocollect"
                                , type: "POST"
                                , data: {
                                    "userid": userid, "dowid": dowid
                                }
                                , dataType: "json"
                                , success: function (jsonData) {
                                    if (jsonData.success == 200) {
                                        layer.msg("取消成功")
                                        tt.parents(".list").remove()
                                    } else {
                                        layer.msg("取消失败")
                                    }
                                }
                                , error: function (res) {
                                    //////////////////////console.log("ajax提交错误")
                                }
                            })
                            layer.close(index);
                        }
                        , btn2: function (index, layero) {
                            layer.close(index);
                        }
                    });


                })
                renderPager(jsonData.count, 4)
            },
            error: function (jsonData) {

            }
        })
    }

    function ResocollectBt(dowid) {
        ////////////////console.log("按钮")
        ////////////////console.log(dowid, userid)

    }
    function muic(){
        const playerOption = {// 设置播放器基本参数
            container: document.getElementById('aplayer'),
            fixed: true,
            volume:0.7,
            order:'list',
            theme:'#988bbc',
            listFolded:false,
            lrcType:1,
            audio: []
        };
        $.ajax({
            url: "getPlayList",
            data: {"listId":2151920273},
            dataType: "json",
            type: "get",
            success: function (json) {
                //console.log(json);
                playerOption.audio=json;
                var ap = new APlayer(playerOption)
            },
            error: function () {

            }
        })
    }
    muic()
</script>
<script src="assets/autoload.js"></script>
</html>
