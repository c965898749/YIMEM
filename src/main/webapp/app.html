<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>默默</title>
    <link rel="shortcut icon" href="img/favicon.ico">
    <script src="js/setCookie.js"></script>
    <script src="jquery/jquery.js"></script>
    <link rel="stylesheet" href="css/siderBar2.css">
    <link rel="stylesheet" type="text/css" href="css/css.css"/>
    <link rel="stylesheet" type="text/css" href="layui/css/layui.css" media="all"/>
    <script src="js/include.js"></script>
    <script src="js/download.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <link rel="stylesheet" type="text/css" href="assets/waifu.min.css?v=1.4.2"/>
    <script src="assets/jquery.min.js?v=3.3.1"></script>
    <!-- 实现拖动效果，需引入 JQuery UI -->
    <script src="assets/jquery-ui.min.js?v=1.12.1"></script>
    <style>
        #textarea {
            font-family: Arial, Helvetica, sans-serif;
            background: none repeat scroll 0 0 #F5F7FD;
            border: 1px solid #B8BFE9;
            padding: 5px 7px;
            width: 420px;
            /*vertical-align:middle;*/
            height: 130px;
            font-size: 12px;
            margin: 0;
            list-style: none outside none;
        }

        #app_html {
            border-bottom: 2px red solid;
        }

        .videotile {

            overflow: hidden;
            text-overflow: ellipsis;
            /*white-space: wrap;*/
        }

        .none {
            display: none;
        }
    </style>
</head>

<body>
<div id="titleContai">
    <!--<include src="title.html"></include>-->
</div>
<div class="TOP">
    <div class="TOP-nav">
        <div id="home" style="cursor:pointer;">电影</div>
        <div id="home2" style="cursor:pointer;">电视剧</div>
        <div id="home3" style="cursor:pointer;width:56px ">动漫</div>
        <div id="home4" style="cursor:pointer;">综艺</div>
    </div>
</div>
<div class="NAV">
    <div class="NAV-mian-left">
        <div class="classify">
            <div class="top" style="padding: 10px">
                <div class="top-lef" style="width: 60px!important; ">
                    语言
                </div>
                <div class="top-rig" id="top-rig">
                    <a href="javascript:void(0)" data-value="">全部</a>
                    <a href="javascript:void(0)" data-value="国语">国语</a>
                    <a href="javascript:void(0)" data-value="粤语">粤语</a>
                    <a href="javascript:void(0)" data-value="英语">英语</a>
                    <a href="javascript:void(0)" data-value="韩语">韩语</a>
                    <a href="javascript:void(0)" data-value="日语">日语</a>
                    <a href="javascript:void(0)" data-value="法语">法语</a>
                    <a href="javascript:void(0)" data-value="其他">其他</a>
                </div>
            </div>
            <div class="top" style="padding: 10px">
                <div class="top-lef">
                    类型
                </div>
                <div class="top-rig" id="top-rig2">
                    <a href="javascript:void(0)" data-value="">全部</a>
                    <a href="javascript:void(0)" data-value="动作">动作</a>
                    <a href="javascript:void(0)" data-value="喜剧">喜剧</a>
                    <a href="javascript:void(0)" data-value="爱情">爱情</a>
                    <a href="javascript:void(0)" data-value="科幻">科幻</a>
                    <a href="javascript:void(0)" data-value="灾难">灾难</a>
                    <a href="javascript:void(0)" data-value="恐怖">恐怖</a>
                    <a href="javascript:void(0)" data-value="奇幻">奇幻</a>
                    <a href="javascript:void(0)" data-value="战争">战争</a>
                    <a href="javascript:void(0)" data-value="悬疑">悬疑</a>
                    <a href="javascript:void(0)" data-value="犯罪">犯罪</a>
                    <a href="javascript:void(0)" data-value="惊悚">惊悚</a>
                    <a href="javascript:void(0)" data-value="动画">动画</a>
                    <a href="javascript:void(0)" data-value="伦理">伦理</a>
                    <a href="javascript:void(0)" data-value="剧情">剧情</a>
                    <a href="javascript:void(0)" data-value="冒险">冒险</a>
                    <a href="javascript:void(0)" data-value="历史">历史</a>
                    <a href="javascript:void(0)" data-value="家庭">家庭</a>
                    <a href="javascript:void(0)" data-value="歌舞">歌舞</a>
                    <a href="javascript:void(0)" data-value="传记">传记</a>
                    <a href="javascript:void(0)" data-value="音乐">音乐</a>
                    <a href="javascript:void(0)" data-value="西部">西部</a>
                    <a href="javascript:void(0)" data-value="运动">运动</a>
                    <a href="javascript:void(0)" data-value="古装">古装</a>
                    <a href="javascript:void(0)" data-value="家庭">家庭</a>
                    <a href="javascript:void(0)" data-value="情色">情色</a>
                    <a href="javascript:void(0)" data-value="同性">同性</a>
                    <a href="javascript:void(0)" data-value="武侠">武侠</a>
                    <a href="javascript:void(0)" data-value="短片">短片</a>
                    <a href="javascript:void(0)" data-value="黑色电影">黑色电影</a>
                    <a href="javascript:void(0)" data-value="儿童">儿童</a>
                    <a href="javascript:void(0)" data-value="舞台艺术">舞台艺术</a>
                    <a href="javascript:void(0)" data-value="纪录片">纪录片</a>
                    <a href="javascript:void(0)" data-value="鬼怪">鬼怪</a>
                </div>
            </div>
            <div class="top" style="padding: 10px">
                <div class="top-lef" style="width: 60px!important; ">
                    年代
                </div>
                <div class="top-rig" id="top-rig3">
                    <a href="javascript:void(0)" data-value="">全部</a>
                    <a href="javascript:void(0)" data-value="2020">2020</a>
                    <a href="javascript:void(0)" data-value="2019">2019</a>
                    <a href="javascript:void(0)" data-value="2018">2018</a>
                    <a href="javascript:void(0)" data-value="2017">2017</a>
                    <a href="javascript:void(0)" data-value="2016">2016</a>
                    <a href="javascript:void(0)" data-value="2015">2015</a>
                    <a href="javascript:void(0)" data-value="2014">2014</a>
                    <a href="javascript:void(0)" data-value="2013">2013</a>
                    <a href="javascript:void(0)" data-value="2012">2012</a>
                    <a href="javascript:void(0)" data-value="2011">2011</a>
                    <a href="javascript:void(0)" data-value="2010">2010</a>
                    <a href="javascript:void(0)" data-value="2009">2009</a>
                    <a href="javascript:void(0)" data-value="2008">2008及以前</a>
                </div>
            </div>
            <div class="top" style="padding: 10px">
                <div class="top-lef" style="width: 60px!important; ">
                    地区
                </div>
                <div class="top-rig" id="top-rig4">
                    <a href="javascript:void(0)" data-value="">全部</a>
                    <a href="javascript:void(0)" data-value="大陆">大陆</a>
                    <a href="javascript:void(0)" data-value="香港">香港</a>
                    <a href="javascript:void(0)" data-value="台湾">台湾</a>
                    <a href="javascript:void(0)" data-value="美国">美国</a>
                    <a href="javascript:void(0)" data-value="法国">法国</a>
                    <a href="javascript:void(0)" data-value="英国">英国</a>
                    <a href="javascript:void(0)" data-value="日本">日本</a>
                    <a href="javascript:void(0)" data-value="韩国">韩国</a>
                    <a href="javascript:void(0)" data-value="德国">德国</a>
                    <a href="javascript:void(0)" data-value="泰国">泰国</a>
                    <a href="javascript:void(0)" data-value="印度">印度</a>
                    <a href="javascript:void(0)" data-value="意大利">意大利</a>
                    <a href="javascript:void(0)" data-value="西班牙">西班牙</a>
                    <a href="javascript:void(0)" data-value="加拿大">加拿大</a>
                    <a href="javascript:void(0)" data-value="其他">其他</a>
                </div>
            </div>
            <div class="snsearch">
                <div class="search-left">
                    关键词：
                </div>
                <input type="text" class="searchtext" name="search" value="">
                <input type="button" value="搜 索" class="searchbtn" onclick="searchbtn()">
            </div>
        </div>

        <!--<div class="ad">-->

        <!--</div>-->
        <div class="downloadlist" id="downloadlist" style="display: flex;background: #F5F6F7">
            <div data-value="1"
                 style="font-size: 14px;height: 30px;width:50px;text-align: center;line-height: 30px;border: #dedede 1px solid;border-bottom: none;background: white;cursor:pointer">
                最新
            </div>
            <div data-value="3"
                 style="font-size: 14px;height: 30px;width:50px;text-align: center;line-height: 30px;border: #dedede 1px solid;background: white;cursor:pointer">
                热门
            </div>
            <div data-value="2"
                 style="font-size: 14px;height: 30px;width:50px;text-align: center;line-height: 30px;border: #dedede 1px solid;background: white;cursor:pointer">
                好评
            </div>
        </div>
        <div class="contextlist" style="display: flex;flex-wrap: wrap;background: white;padding: 10px;">


        </div>
        <div id="pageContainer" style="margin-left: 200px"></div>
    </div>
    <div class="NAV-mian-right">
        <div class="ad">
            <img src="imgs/ad/blog/cd18.png"/>
        </div>
        <div class="upload" id="uploadIndex" onclick="uploadIndex()"
             style="background: #EBEDF2;text-align: center;font-size: 14px;color: #868B96;border: 2px #E3E5EB solid;cursor: pointer ">
            留言求片
        </div>
        <div class="recommend">

        </div>
        <div class="yimem_gg">
            <img src="imgs/ad/blog/cd17.png">
        </div>
        <!--<img src="imgs/introduce/csdn.png">-->
        <div class="yimem_bz" style="background-color: white;margin-top: 10px;">
            <div style="width:300px;margin:0 auto">
                <img src="imgs/gz/gz.jpg" style="margin-top: 5px;margin-left: 30px;height: 100px;width: 100px" alt="">
                <img src="imgs/gz/eduwxfix.png" style="margin-top: 5px;margin-left: 30px;height: 100px;width: 100px"
                     alt="">
            </div>
            <div style="padding-bottom: 5px;margin: 0 auto;width: 250px ;border-bottom: 1px #E0E0E0 solid"><span
                    style="color:#8B8B8B;margin-left: 15px">YIMEM公众号</span><span
                    style="color:#8B8B8B;margin-left: 60px">IT学院</span></div>
            <div style="padding-top: 5px;margin: 0 auto;width: 250px"><span
                    style="color:#3D3D3D;font-weight: bold;margin-left: 20px">关于我们</span>
                <span
                        style="color:#3D3D3D;margin-left: 20px">网站地图</span><span
                        style="color:#3D3D3D;margin-left: 20px">广告服务</span></div>
            <div style="width:300px;margin:0 auto; padding:20px 0;">
                <img src="imgs/jh/jh.png" style="margin-left: 30px;margin-top: -15px" alt=""> <a target="_blank"
                                                                                                 href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32061202001097"
                                                                                                 style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img
                    src="" style="float:left;"/>
                <p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">苏公网安备
                    32061202001097号</p></a>
            </div>
        </div>
    </div>
</div>
<div class="NAV2">
    <div style="margin: 0 auto;text-align:center;font-size: 16px;font-weight: bolder">资源暂时不开放</div>
</div>
<div class="NAV3">
    <div style="margin: 0 auto;text-align:center;font-size: 16px;font-weight: bolder">资源暂时不开放</div>
</div>
<div class="NAV4">
    <div style="margin: 0 auto;text-align:center;font-size: 16px;font-weight: bolder">资源暂时不开放</div>
</div>
<div class="siderBar">
    <ul>
        <li>返回</li>
        <li>顶部</li>
        <div>
            <div class="siderBar-line"></div>
            <div class="siderBar-goTop" id="btn"></div>
        </div>
    </ul>
</div>

</body>
<script src="layui/layui.all.js"></script>
<script>
    var navH = $(".yimem_gg").offset().top;
    var page = 1;
    var pageSize = 24;
    var state = 1;
    var laypage;
    var layer;
    var type = "";
    var director = "";
    var createtime = "";
    var region = "";
    var title = "";
    //获取登入者ID
    $("#titleContai").load("title.html")
    var user = getUser();
    var userid = 0;
    if (user) {
        userid = user.userId
    }
    //引用表头
    // $("#titleContai").load("title.html")
    $(function () {
        ajaxGetInvitation(1)
        $(".myintegrals").hide()
        taplan(getQueryString("type"))
        jinpin();
        $("#allupload").css("background-color", "red")
        $("#allupload").css("color", "white")
        $("#allupload").siblings().css("background-color", "")
        $("#allupload").siblings().css("color", "black")

    });

    function renderPager(totalCount) {
        laypage = layui.laypage;
        laypage.render({
            elem: 'pageContainer'
            , count: totalCount
            , limit: pageSize
            , curr: page
            , limits: [3, 5, 10, 20, 30, 40, 50]
            , layout: ['prev', 'page', 'next', 'skip']
            , jump: function (obj, first) {
                //obj包含了当前分页的所有参数，比如：
                //////////////////////console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
                //////////////////////console.log(obj.limit); //得到每页显示的条数

                //首次不执行
                if (!first) {

                    //把分页值，和分页量（分页量可能会变化）
                    page = obj.curr;
                    pageSize = obj.limit;
                    ajaxGetInvitation(page)
                }
            }
        });

    }

    function ajaxGetInvitation(page) {
        $.ajax({
            url: "getVideo"
            ,
            type: "GET"
            ,
            data: {
                "pageNum": page,
                "state": state,
                "createtime": createtime,
                "director": director,
                "region": region,
                "type": type,
                "title": title
            }
            ,
            dataType: "json"
            // , async: false
            ,
            success: function (jsonData) {
                // console.log(jsonData)
                $(".contextlist").empty()
                var data = jsonData.data;
                var html = "";
                $.each(data, function (k, v) {
                    var guoyu = null;
                    var y = v.director.replace(/:/g, " ")
                    var reg = RegExp(/国语/);
                    if (reg.test(y)) {
                        guoyu = "国语";
                    }
                    //////////////////////console.log(v)
                    html += ` <div class="videolist" style="margin: 5px;width: 135px;height: 245px;">
                <a href="appDetail.html?videoid=${v.videoid}">
                    <div class="img" style="width: 135px;height: 170px;position: relative">
                    <div class="${v.douban == null ? 'none' : ''}" style="position: absolute;background: #F57C00;padding: 5px;color: white">${v.douban}</div>
                    <div class="${guoyu == null ? 'none' : ''}" style="position: absolute;background: #FFE600;border: 1px white solid;padding: 3px;color: black;left: 100px;font-size: 12px;top:147px">国语</div>
                        <img src="${v.coverurl}" style="width: 100%;height: 100%" alt="">
                    </div>
                    <div class="videotile" style="width: 135px;height: 35px;margin-top: 5px;text-align: center;">
                        <span style="font-weight: 700;font-size: 14px">${v.title}</span>
                    </div>
                </a>
            </div>`;

                });
                $(".contextlist").append(html);
                renderPager(jsonData.count)
            }
            ,
            error: function (res) {
                //////////////////////////console.log("ajax提交错误")
            }
        })
    }

    // 点击变色
    $(".downloadlist").on("click", "div", function () {
        console.log(11111)
        $(this).css("border-bottom", "none")
        $(this).siblings().css("border-bottom", "#dedede 1px solid")
        state = $(this).attr('data-value');
        console.log(state)
        ajaxGetInvitation(1)
    })
    // 点击变色
    $("#top-rig").on("click", "a", function () {
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
        director = $(this).attr('data-value');
    })
    // 点击变色
    $("#top-rig2").on("click", "a", function () {
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
        type = $(this).attr('data-value');
    })
    // 点击变色
    $("#top-rig3").on("click", "a", function () {
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
        createtime = $(this).attr('data-value');
    })
    // 点击变色
    $("#top-rig4").on("click", "a", function () {
        $(this).css("color", "red")
        $(this).siblings().css("color", "black")
        region = $(this).attr('data-value');
    })

    function searchbtn() {
        title = $("input[name='search']").val()
        console.log(director + ";" + region + ";" + createtime + ";" + type)
        ajaxGetInvitation(1)
    }

    window.onscroll = function () {

        var scroH = $(this).scrollTop();
        if (scroH - 600 >= navH) {
            $(".yimem_gg").css({"position": "fixed", "top": 10});
            $(".yimem_bz").css({"position": "fixed", "top": 260});
        } else {
            $(".yimem_gg").css({"position": "static"});
            $(".yimem_bz").css({"position": "static"});
        }

    }


    var timer = null;
    document.getElementById("btn").onclick = function () {
        cancelAnimationFrame(timer);
        timer = requestAnimationFrame(function fn() {
            var oTop = document.body.scrollTop || document.documentElement.scrollTop;
            if (oTop > 0) {
                scrollBy(0, -50);
                timer = requestAnimationFrame(fn);
            } else {
                cancelAnimationFrame(timer);
            }
        });
    }

    function uploadIndex() {
        layer.open({
            type: 1,
            area: ['440px', '250px'],
            content: '<textarea id="textarea" rows="4" placeholder="留下你最想看的影视……#^_^#"></textarea>'
            , btn: ['发送', '取消']
            , title: ['留言', 'color:white;background-color:#3BB9B6;']
            , yes: function (index, layero) {
                //按钮【按钮一】的回调
                layer.closeAll()
            }
            , btn2: function (index, layero) {
                //按钮【按钮二】的回调

                //return false 开启该代码可禁止点击该按钮关闭
            }
            , cancel: function () {
                //右上角关闭回调

                //return false 开启该代码可禁止点击该按钮关闭
            }
        });
    }

    //精品渲染
    function jinpin() {
        $.ajax({
            url: "getVideohotcount",
            type: "get",
            dataType: "json",
            success: function (jsonData) {
                var i=0;
                var html = ` <div class="top" style="display: flex;justify-content : space-between;">
                <div class="left">
                    <span style="font-size: 14px;color: #868B96">人气电影</span>
                </div>
                <div class="right">
                    <span style="color: #888;font-size: 14px;">
                    <a href="blog_page.html" style="font-size: 14px;color: #868B96">更多</a>
                    </span>
                </div>
            </div>`;
                $(".recommend").append(html);
                var data = jsonData.data;
                console.log(data)
                var html = "";
                $.each(data, function (k, v) {
                    if (i < 3) {
                        html += ` <a href="/appDetail.html?videoid=${v.videoid}" target="_blank">
                        <ul class="danmuLi" style="height: 50px;margin-top: 15px">
                            <li>
                                <hr style="margin-top: 20px;"/>
                                <div class="currentTime" style="width: 37px;color: #888888 "><img style="height: 100%;width: 100%" src="${v.coverurl}" alt=""></div>
                            </li>
                            <li style="margin-left: 53px;margin-top: -50px;display: flex;">
                                <div class="msg" style="color: #888888 ">${v.title}</div>
                                <div class="createTime" style="color: #888888;transform:scale(0.8);margin-left: auto;">播放量:${v.clickcount}</div>
                            </li>

                        </ul>
                    </a>`;
                    } else {
                        var yu = "英语";
                        if (v.director.substr(1, 2) != null) {
                            yu = v.director.substr(1, 2);
                        }
                        html += `<a href="/appDetail.html?videoid=${v.videoid}" target="_blank">
                       <ul class="danmuLi" style="height: 25px;margin-top: 15px">
                        <li style="display: flex;">
                            <div class="currentTime" style="color: #888888 ">[${yu}]</div>
                            <div class="msg" style="color: #888888 ">${v.title}</div>
                            <div class="createTime" style="color: #888888;transform:scale(0.8);margin-left: auto;">播放量:${v.clickcount}</div>
                            <hr style="margin-top: 0px"/>
                        </li>
                    </ul></a>`;
                    }
                    i++;
                    if (i == 10) {
                        return false;
                    }
                })
                $(".recommend").append(html);

            },
            error: function (err) {

            }
        })
    }

    // tap选项卡
    $("#home2").click(function () {
        window.history.pushState({status: 0}, '', '?type=2')
        taplan(2)

    })
    $("#home").click(function () {
        taplan(1)
        window.history.pushState({status: 0}, '', '?type=1')
    })

    $("#home3").click(function () {
        taplan(3)
        window.history.pushState({status: 0}, '', '?type=3')

    })
    $("#home4").click(function () {
        taplan(4)
        window.history.pushState({status: 0}, '', '?type=4')

    })




    function taplan(type) {
        // $("#cldtop-rig").hide()
        if (type == null) {
            $(".NAV2").hide();
            $(".NAV3").hide();
            $(".NAV4").hide();
            $(".NAV").show()
            $("#home").css("border-bottom", "2px red solid")
            $("#home2").css("border-bottom", "none")
            $("#home3").css("border-bottom", "none")
            $("#home4").css("border-bottom", "none")
        } else {
            if (type == 1) {
                $(".NAV2").hide();
                $(".NAV3").hide();
                $(".NAV4").hide();
                $(".NAV").show()
                $("#home").css("border-bottom", "2px red solid")
                $("#home2").css("border-bottom", "none")
                $("#home3").css("border-bottom", "none")
                $("#home4").css("border-bottom", "none")
            } else if (type == 2) {
                $(".NAV").hide();
                $(".NAV3").hide();
                $(".NAV4").hide();
                $(".NAV2").show()
                $("#home2").css("border-bottom", "2px red solid")
                $("#home").css("border-bottom", "none")
                $("#home3").css("border-bottom", "none")
                $("#home4").css("border-bottom", "none")
            } else if (type == 3) {
                $(".NAV2").hide();
                $(".NAV").hide();
                $(".NAV4").hide();
                $(".NAV3").show()
                $("#home3").css("border-bottom", "2px red solid")
                $("#home2").css("border-bottom", "none")
                $("#home").css("border-bottom", "none")
                $("#home4").css("border-bottom", "none")
            }else if (type == 4) {
                $(".NAV2").hide();
                $(".NAV3").hide();
                $(".NAV").hide();
                $(".NAV4").show()
                $("#home4").css("border-bottom", "2px red solid")
                $("#home2").css("border-bottom", "none")
                $("#home3").css("border-bottom", "none")
                $("#home").css("border-bottom", "none")
            }
        }
    }


    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return r[2];
        return null;
    }


    //获取当前用户
    function getUser() {
        var data;
        $.ajax({
            url: "isEnter"
            , type: "get"
            , dataType: "json"
            , async: false
            , success: function (jsonData) {
                //////////////////////////console.log(jsonData)
                if (jsonData.success == 1) {
                    data = jsonData.data;
                }
            }
            , error: function (res) {
                //////////////////////////console.log("ajax提交错误")
            }
        })
        return data;
    }


</script>
<script src="assets/autoload.js"></script>
</html>
