<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <title>论坛</title>
        <link rel="shortcut icon" href="statics/img/favicon.ico">

        <link rel="stylesheet" type="text/css" href="css/css.css"/>
        <link rel="stylesheet" type="text/css" href="layui/css/layui.css"/>
        <script type="text/javascript" src="./kindeditor/kindeditor-all.js"></script>
        <script type="text/javascript" src="./kindeditor/lang/zh-CN.js"></script>
        <script src="js/jquery.js"></script>
        <script src="js/download.js"></script>
        <script src="js/include.js"></script>
        <script type="text/javascript" src="syntax/scripts/shCore.js"></script>
        <script type="text/javascript" src="syntax/scripts/shBrushJScript.js"></script>
        <script type="text/javascript" src="syntax/scripts/shBrushXml.js"></script>
        <script type="text/javascript" src="syntax/scripts/shBrushJava.js"></script>
        <script type="text/javascript" src="syntax/scripts/shBrushCss.js"></script>
        <script type="text/javascript" src="syntax/scripts/shBrushPython.js"></script>
        <script type="text/javascript" src="syntax/scripts/shBrushPhp.js"></script>
        <link type="text/css" rel="stylesheet" href="syntax/styles/shCoreDefault.css"/>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
        <style>
            #forum_html{
                border-bottom: 2px red solid;
            }
            .NAV .NAV-mian-left .top {
                display: flex;
                justify-content: space-between;
                width: 890px;
                height: 30px;
                background-color: #E3E6E8;
                margin-top: 10px;
                padding: 10px;
                box-sizing: border-box;
            }

            .Faquality:hover .quality {
                display: block;
            }

            .quality {
                display: none;
            }

            /*.TOP .TOP-nav .Faquality .quality {*/
                /*padding: 10px;*/
                /*box-sizing: border-box;*/
                /*!*margin-top: 5px;*!*/
            /*}*/
            /*.MajorBBS{*/
                /*padding: 10px;*/
                /*box-sizing: border-box;*/
            /*}*/
            .MajorBBS thead th,.MajorBBS tbody td{
                /*background-color: white;*/
                /*width: 890px;*/
                /*height: 20px;*/
                text-align: center;
                line-height: 25px;
            }
            .MajorBBS thead th a{
                color: #337ABD;
                cursor: pointer;
                font-size: 12px;
            }

            /*.TOP .TOP-nav .Faquality .quality thead th,*/
            /*.TOP .TOP-nav .Faquality .quality tbody td {*/
                /*!*margin-top: 10px;*!*/
                /*width: 160px;*/
                /*!*height: 20px;*!*/
                /*text-align: center;*/
                /*line-height: 25px;*/
            /*}*/

            /*.TOP .TOP-nav .Faquality .quality tbody td a {*/
                /*color: #337ABD;*/
                /*cursor: pointer;*/
                /*font-size: 12px;*/
            /*}*/

            /*.TOP .TOP-nav .Faquality .quality tbody td:hover {*/
            /*color: red;*/
            /*}*/

            .left-nav {
                width: 200px;
                min-height: 800px;
                border: 2px #E3E6E8 solid;
                /*background-color: #0C0C0C;*/
                position: fixed;
                top: 100px;
                z-index: 99999;
                /*overflow: hidden;*/
            }

            .shousuo {
                position: fixed;
                z-index: 9999999;
                left: 200px;
                top: 360px;
            }

            .NAV-upload {
                background-color: white;
                width: 960px;
                margin: 0 auto;
                min-height: 1000px;
                padding: 20px;
                box-sizing: border-box;
               overflow: hidden;
            }

            .NAV-upload .textareaContain, #preview {
                margin-top: 10px;
                min-height: 500px;
                width: 920px;
                /*margin: 0 auto;*/
                margin-bottom: 20px;
                background-color: white;
            }

            #preview {
                border: #CCCCCC 1px solid;
            }

            .NAV-upload .textareaContain textarea {
                width: 100%;
                height:500px;
            }


        </style>
    </head>

    <body>
    <div id="titleContai">
        <include src="title.html" ></include>
    </div>
        <div class="shousuo">
            <input type="button"
                   style="background: url('imgs/icons/blog/_20190815190550.png');background-repeat: no-repeat;width: 20px;height: 100px;border: none"
                   value="">
        </div>
        <div class="left-nav">

            <div id="treemenu" style="font-size: 12px">

            </div>


        </div>
        <div class="TOP">
            <div class="TOP-nav">
                <div id="home" style="cursor:pointer;">论坛首页</div>
                <!--<div class="Faquality" style="cursor:pointer;">个人版块</div>-->
                <div id="myresources" style="cursor:pointer;">个人版块</div>
                <div id="upload" style="cursor:pointer;margin-left: -20px">我要发帖</div>
            </div>
        </div>
        <div class="NAV">
            <div class="NAV-mian-left">

                <div class="ad">

                </div>

                <!--模块-->
                <div class="HotSkill">
                    <div class="top"><span>热帖.技术区</span><span><a href="hotforumsubdivide.html">更多</a></span></div>
                    <table class="layui-table" lay-skin="line">
                        <colgroup>
                            <col width="600">
                            <col width="150">
                            <col>
                        </colgroup>
                        <thead>
                        <tr>
                            <th>标题</th>
                            <th>发帖人</th>
                            <th>人气</th>
                        </tr>
                        </thead>
                        <tbody class="tbHotSkill">

                        </tbody>
                    </table>
                </div>
                <div class="FrumSkill">
                    <div class="top"><span>版主推荐.技术区</span><span><a href="Allforumsubdivide.html">更多</a></span></div>
                    <table class="layui-table" lay-skin="line">
                        <colgroup>
                            <col width="700">
                        </colgroup>
                        <tbody class="tbFrumSkill">
                        </tbody>
                    </table>
                </div>
                <div class="HotLiving">
                    <div class="top"><span>热帖.生活区</span><span><a href="forumsubdivide.html?id=182&pid=20">更多</a></span></div>
                    <table class="layui-table" lay-skin="line">
                        <colgroup>
                            <col width="600">
                            <col width="150">
                            <col>
                        </colgroup>
                        <thead>
                        <tr>
                            <th>标题</th>
                            <th>发帖人</th>
                            <th>人气</th>
                        </tr>
                        </thead>
                        <tbody class="tbHotLiving">

                        </tbody>
                    </table>
                </div>
                <div class="ForumLiving">
                    <div class="top"><span>版主推荐.生活区</span><span><a href="forumsubdivide.html?id=226&pid=24">更多</a></span></div>
                    <table class="layui-table" lay-skin="line">
                        <colgroup>
                            <col width="700">
                        </colgroup>
                        <tbody class="tbForumLiving">

                        </tbody>
                    </table>
                </div>
                <div class="MajorBBS">
                    <div class="top"><span>主要论坛分类</span></div>
                    <div class="mainBBS" style="background-color: white">

                    </div>

                </div>
            </div>

            <div class="NAV-mian-right">
                <div class="ad">
                    <img src="imgs/ad/blog/cd18.png"/>
                </div>
                <div class="upload" id="uploadIndex">

                </div>
                <div>
                    <img src="imgs/btn/blog/_20190815192045.png" alt="">
                </div>
                <div class="recommend">
                    <div class="top" style="display: flex;justify-content : space-between;">
                        <div class="left">
                            <span style="font-size: 16px;">精品推荐</span>
                        </div>
                        <div class="right">
								<span style="color: #888;font-size: 14px;">
								更多
							     </span>
                        </div>
                    </div>
                    <div class="list">
                        <div class="title">
                            机器学习极简入门课
                        </div>
                        <div class="author" style="border-bottom: 1px #E6E6E6 solid;height: 30px;margin-top: 10px;">
							<span style="color: #888;font-size: 14px;">
									作者/分享人：李烨 · 微软高级软件工程师
							     </span>
                        </div>
                    </div>
                    <div class="list">
                        <div class="title">
                            机器学习极简入门课
                        </div>
                        <div class="author" style="border-bottom: 1px #E6E6E6 solid;height: 30px;margin-top: 10px;">
							<span style="color: #888;font-size: 14px;">
									作者/分享人：李烨 · 微软高级软件工程师
							     </span>
                        </div>
                    </div>
                    <div class="list">
                        <div class="title">
                            机器学习极简入门课
                        </div>
                        <div class="author" style="border-bottom: 1px #E6E6E6 solid;height: 30px;margin-top: 10px;">
							<span style="color: #888;font-size: 14px;">
									作者/分享人：李烨 · 微软高级软件工程师
							     </span>
                        </div>
                    </div>
                </div>
                <div class="weichat">
                    <div class="yimem_gg">
                        <img src="imgs/ad/blog/cd17.png">
                    </div>
                    <!--<img src="imgs/introduce/csdn.png">-->
                    <div class="yimem_bz" style="background-color: white;margin-top: 10px;">
                        <div style="width:300px;margin:0 auto">
                            <img src="imgs/gz/gz.jpg" style="margin-top: 5px;margin-left: 30px;height: 100px;width: 100px" alt="">
                            <img src="imgs/gz/eduwxfix.png" style="margin-top: 5px;margin-left: 30px;height: 100px;width: 100px"
                                 alt="">
                        </div>
                        <div style="padding-bottom: 5px;margin: 0 auto;width: 250px ;border-bottom: 1px #E0E0E0 solid"><span style="color:#8B8B8B;margin-left: 15px">YIMEM公众号</span><span
                                style="color:#8B8B8B;margin-left: 60px">IT学院</span></div>
                        <div style="padding-top: 5px;margin: 0 auto;width: 250px"><span style="color:#3D3D3D;font-weight: bold;margin-left: 20px">关于我们</span>
                            <span
                                    style="color:#3D3D3D;margin-left: 20px">网站地图</span><span
                                    style="color:#3D3D3D;margin-left: 20px">广告服务</span></div>

                    </div>
                </div>
            </div>
        </div>
    <div class="NAV-myresouces">
        <div class="top-user" style="display:flex;padding: 10px">
            <div>
                <div class="top" id="top" style="width: 500px;">

                </div>
                <div class="count" id="count" style="width:500px ">

                </div>
            </div>

            <div class="top-rig">
                <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
                <div id="main" style="width: 500px;height:240px;">
                    <div style="border-left: 2px red solid;"><span style="margin-left: 10px">勋章</span></div>
                    <div>
                        <div>拥有的勋章</div>
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal1.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal3.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal4.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal5.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal7.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/gtaezn.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal7.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal9.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal7.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/gtaszn.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/jcbz.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal9.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal7.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal9.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal_avatar_big.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal9.gif" alt="">
                    </div>
                    <div>
                        <div>已佩戴勋章</div>
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal1.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal3.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal4.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal5.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal7.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/gtaezn.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal7.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal9.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal7.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/gtaszn.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/jcbz.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal9.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal7.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal9.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal_avatar_big.gif" alt="">
                        <img style="margin-left: 10px;margin-bottom: 5px" src="imgs/xunzhan/medal9.gif" alt="">
                    </div>
                </div>

            </div>
        </div>
        <div class="NAV-myresouces-mian">
            <div class="main-lf">
                <div style="width: 890px;height: 42px;background-color:#EEF1F3;line-height: 42px;display: flex;">
                    <div id="uploadcld"
                         style="font-size: 16px;color: red;background-color: white;padding-left: 20px;width: 120px;height: 42px;cursor: pointer;">
                        历史发帖
                    </div>
                    <div id="integralcld"
                         style="font-size: 16px;color: red;padding-left: 20px;width: 120px;height: 42px; cursor: pointer;">
                        我的论坛
                    </div>
                    <div id="downcld"
                         style="font-size: 16px;color: red;padding-left: 20px;width: 120px;height: 42px;cursor: pointer;">
                        我的回复
                    </div>
                    <div id="collentcld"
                         style="font-size: 16px;color: red;padding-left: 20px;width: 120px;height: 42px; cursor: pointer;">
                        TA的回复
                    </div>
                </div>
                <div class="myintegrals">
                    <div class="lists">
                        <table   class="layui-table">
                            <colgroup>
                                <col width="180">
                                <col width="180">
                                <col width="180">
                            </colgroup>
                            <thead>
                            <tr>
                                <th>论坛</th>
                                <th>版主</th>
                                <th>操作</th>
                            </tr>
                            </thead>
                            <tbody id="mixi">

                            </tbody>
                        </table>
                    </div>

                </div>
                <div class="myresouces" id="myresouces">
                    <div class="nav">
                        <div id="allupload" onclick="allupload()" style="cursor: pointer;">全部</div>
                        <div id="waitpassupload" onclick="waitpassupload()" style="cursor: pointer;">精华贴</div>
                        <div id="passupload" onclick="passupload()" style="cursor: pointer;">最新贴</div>
                        <div id="nopassupload" onclick="nopassupload()" style="cursor: pointer;">已删除</div>
                    </div>
                    <div class="lists" id="Invitation">


                    </div>
                </div>

            </div>
            <div class="main-rt">
                <div class="upload">
                    <input type="button" value="我要发帖" class="uploadbtn">
                </div>
                <div class="weichat">
                    <div class="yimem_gg">
                        <img src="imgs/ad/blog/cd17.png">
                    </div>
                    <!--<img src="imgs/introduce/csdn.png">-->
                    <div class="yimem_bz" style="background-color: white;margin-top: 10px;">
                        <div style="width:300px;margin:0 auto">
                            <img src="imgs/gz/gz.jpg" style="margin-top: 5px;margin-left: 30px;height: 100px;width: 100px" alt="">
                            <img src="imgs/gz/eduwxfix.png" style="margin-top: 5px;margin-left: 30px;height: 88px;width: 88px"
                                 alt="">
                        </div>
                        <div style="padding-bottom: 5px;margin: 0 auto;width: 250px ;border-bottom: 1px #E0E0E0 solid"><span style="color:#8B8B8B;margin-left: 15px">YIMEM公众号</span><span
                                style="color:#8B8B8B;margin-left: 60px">IT学院</span></div>
                        <div style="padding-top: 5px;margin: 0 auto;width: 250px"><span style="color:#3D3D3D;font-weight: bold;margin-left: 20px">关于我们</span>
                            <span
                                    style="color:#3D3D3D;margin-left: 20px">网站地图</span><span
                                    style="color:#3D3D3D;margin-left: 20px">广告服务</span></div>

                    </div>
                </div>
            </div>
        </div>
        <div id="pageContainer" style="margin-left: 200px"></div>
    </div>
        <div class="NAV-upload">
            <div class="context">
                <form class="layui-form" action="" onSubmit="return false;">
                    <div class="layui-form-item">
                        <!--<label class="layui-form-label">输入标题</label>-->
                        <!--<div class="layui-input-block">-->
                        <input type="text" name="title" required lay-verify="required" placeholder="请输入标题"
                               autocomplete="off" class="layui-input">
                        <!--</div>-->
                    </div>
                    <div class="layui-tab">
                        <ul class="layui-tab-title">
                            <li class="layui-this">编辑</li>
                            <li id="previewbtn">预览</li>
                        </ul>
                        <div class="layui-tab-content">
                            <div class="layui-tab-item layui-show">
                                <div class="textareaContain">

                                    <textarea id="editor_id" name="content"></textarea>
                                </div>
                            </div>
                            <div class="layui-tab-item">
                                <div id="preview">
                                    <!--<pre class="brush:js">DFASFSDFSDFAS</pre>-->
                                </div>
                            </div>
                        </div>
                    </div>

                    <span style="float: right">你还可以输入10000个字符</span>
                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 100px">主题板块</label>
                        <div class="layui-input-inline">
                            <select name="categoryid" lay-verify="required" id="category1" lay-filter="cate1">

                            </select>
                        </div>
                        <div class="layui-input-inline">
                            <select name="categoryid2" lay-verify="required" id="category2">

                            </select>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn kwSumbit" lay-submit lay-filter="createComment" >立即提交</button>
                            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                        </div>
                    </div>
                </form>

                <div style="font-size: 12px;border:1px dashed #CCCCCC;">
                    <p style="margin: 20px auto"> 请遵守YIMEM用户行为准则，不得违反国家法律法规。</p>
                    <p style="margin: 20px auto">转载文章请注明出自“YIMEM（www.yimem.com）”，如是商业用途请联系原作者。</p>
                    <p style="margin: 20px auto">为了维护良好的技术讨论环境，请不要讨论政治 相关话题。</p>
                </div>
            </div>
        </div>
        <div class="flooter">
            <div style="width:300px;margin:0 auto; padding:20px 0;">
                <img src="imgs/jh/jh.png" style="margin-left: 30px;margin-top: -15px" alt=""> <a target="_blank"
                                                                                                 href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32061202001097"
                                                                                                 style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img
                    src="" style="float:left;"/>
                <p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">苏公网安备
                    32061202001097号</p></a>
            </div>
        </div>
    </body>

    <script src="layui/layui.all.js"></script>
    <script>
        // 树状
        var type=0;
        var content = null;
        var user = getUser();
        var userid = 0;
        if (user) {
            userid = user.userId
        }
        var invitation = null;
        var url = null;
        $(function () {
            selcetRoot()
            $("#allupload").css("background-color", "red")
            $("#allupload").css("color", "white")
            $("#allupload").siblings().css("background-color", "")
            $("#allupload").siblings().css("color", "black")
            $(".myintegrals").hide()
            if (userid == 0) {
                var html = ` <a href="login.html"><img src="imgs/btn/blog/_fsdfsdf.png" alt=""style="margin-left: -20px;margin-top: -20px"></a>`
                $("#uploadIndex").append(html)
            } else {
                var html = ` <div class="top">
                        <div class="top-lef"><a href="perInfor.html?viewUserId=`+userid+`&type=blog"> <img class="headimg" style="width: 48px;height: 48px;border-radius: 24px;"
                                 src="` + user.headImg + `"/></a>

                        </div>
                        <div class="top-rig">
                            <div class="username">
                                <a href="">` + user.username + `</a>
                            </div>
                            <div class="grade">
                                <div class="img">
                                    <img src="imgs/icons/blog/down1.png"/>
                                </div>
                                <div class=="context">
									<span style="color: #888;font-size: 12px;">
								积分：
							     </span>
                                    <span style="color: red;">` + user.downloadmoney + `</span>
                                </div>
                            </div>
                        </div>
                    </div>`;
                $("#uploadIndex").append(html)
            }
            xuran()
            taplan(getQueryString("type"))
            ajaxGetCategory()
            getMenu()
        })
        //
        // <div class="mainBBS">
        //
        //     </div>
        // 主论坛
        //获取当前用户
        function selcetRoot() {

            $.ajax({
                url: "selcetRoot"
                , type: "get"
                , dataType: "json"
                , success: function (jsonData) {
                    //////////////////console.log(jsonData)
                    if (jsonData.success == 200) {
                      var   data = jsonData.data;
                        console.log(data)
                        var html='';
                        var html2='';
                        var html3='';
                        var html4='';
                        $.each(data,function (k,v) {
                            html2+=`<th><a href="/forumsubdivide.html?id=${v.id}&pid=0">${v.title}</a></th>`
                            $.each(v.children,function (k,v) {
                                html3+=`<p style="width: 280px"><a href="/forumsubdivide.html?id=${v.id}&pid=0">${v.title}</a></p>`
                            })
                            html4+=`<td>`+html3+` </td>`
                            html3='';
                            k++
                            if (k%3==0){
                                html=`<table>
                                    <thead>
                                        <tr>
                                            `+html2+`
                                        </tr>
                                    </thead>
                                    <tbody>
                                            `+html4+`
                                    </tbody>
                                </table>
                                <div style="border-bottom:1px dashed #E3E6E8;"></div>`
                                $(".mainBBS").append(html);
                                 html='';
                                 html2='';
                                 html3='';
                                 html4='';
                            }
                            console.log(data.length)
                            if (data.length%3!=0&&(data.length-k)==0){
                                html=`<table>
                                    <thead>
                                        <tr>
                                            `+html2+`
                                        </tr>
                                    </thead>
                                    <tbody>
                                            `+html4+`
                                    </tbody>
                                </table>
                                <div style="border-bottom:1px dashed #E3E6E8;"></div>`
                                $(".mainBBS").append(html);
                                html='';
                                html2='';
                                html3='';
                                html4='';
                            }
                        })
                    }
                }
                , error: function (res) {
                    //////////////////console.log("ajax提交错误")
                }
            })

        }
        // 个人信息渲染
        function people() {
            var html = `<div class="top-lefw"><a href="perInfor.html?viewUserId=` + userid + `&type=blog"> <img class="headimg" style="width: 98px;height: 98px;border-radius: 48px"
                         src="` + user.headImg + `"/></a>

                </div>
                <div class="top-model">
                    <div class="username">
                        <a href="" style="font-size: 16px;">` + user.username + `</a>
                    </div>
                    <div class="grade">
                        <div class="img">
                            <img src="imgs/icons/blog/down1.png"/>
                        </div>
                        <div class=="context">
					<span style="color: #888;font-size: 12px;">
				论坛权限：
			     </span>
                            <span style="color:#888;">1级</span>
                        </div>
                    </div>
                </div>`;
            $("#top").append(html)
            var html2 = `<div class="integral">
                    <div class="top">
                        积分
                    </div>
                    <div class="foolt" style="margin-top: 10px;">
			<span style="color: #FF9358;font-size: 24px;text-align:center ;">
				` + user.downloadmoney + `
			</span>
                    </div>
                </div>
                <div class="integral">
                    <div class="top">
                        总排名

                    </div>
                    <div class="foolt" style="margin-top: 10px;">
			<span style="color: #FF9358;font-size: 24px;">
				0
			</span>
                    </div>
                </div>
                <div class="integral">
                    <div class="top">
                        总帖子
                    </div>
                    <div class="foolt" style="margin-top: 10px;">
			<span style="color: #FF9358;font-size: 24px;">
				` + user.resourceCount + `
			</span>
                    </div>
                </div>
                <div class="integral">
                    <div class="top">
                        加精贴
                    </div>
                    <div class="foolt" style="margin-top: 10px;">
			<span style="color: #FF9358;font-size: 24px;">
				` + user.downCount + `
			</span>
                    </div>
                </div>`
            $("#count").append(html2)

        }

        // 菜单点击事件

        $("#uploadcld").click(function () {
            $(".NAV-myresouces .NAV-myresouces-mian .main-lf .nav").show()
            // mokuai = 1
            // page2=1
            // pageSize2=4
            // ajaxGetInvitation(1, 4)
        })
        // 积分明细
        $("#integralcld").click(function () {
            // mokuai = 2
            // page2=1
            // pageSize2=10
            // integralcld(1, 10)
        })

        // 下载明细
        $("#downcld").click(function () {
            $(".NAV-myresouces .NAV-myresouces-mian .main-lf .nav").hide()
            // mokuai = 3
            // page2=1
            // pageSize2=4
            // downcld(1, 4)
        })

        // 收藏明细
        $("#collentcld").click(function () {
            $(".NAV-myresouces .NAV-myresouces-mian .main-lf .nav").hide()
            $("#myresouces").hide()
            // mokuai = 4
            // page2=1
            // pageSize2=4
            // Resocollect(1, 4)
        })
        //获取当前用户
        function getUser() {
            var data;
            $.ajax({
                url: "isEnter"
                , type: "get"
                , dataType: "json"
                , async: false
                , success: function (jsonData) {
                    //////////////////console.log(jsonData)
                    if (jsonData.success == 1) {
                        data = jsonData.data;
                    }
                }
                , error: function (res) {
                    //////////////////console.log("ajax提交错误")
                }
            })
            return data;
        }


        $("#myresources").click(function () {
            $("#count").empty()
            $("#top").empty()
            window.history.pushState({status: 0} ,'' ,'?type=2')
            taplan(2)

        })
        $("#home").click(function () {
            taplan(1)
            window.history.pushState({status: 0} ,'' ,'?type=1')
        })

        $("#upload").click(function () {
            taplan(3)
            window.history.pushState({status: 0} ,'' ,'?type=3')

        })
        function taplan(type){
            $("#cldtop-rig").hide()

            if (type==null){
                $(".NAV-myresouces").hide();
                $(".NAV-upload").hide()
                $(".NAV").show()
                $("#home").css("border-bottom", "2px red solid")
                $("#myresources").css("border-bottom", "none")
                $("#upload").css("border-bottom", "none")
            } else {
                if (type==1){
                    $(".NAV-myresouces").hide();
                    $(".NAV-upload").hide()
                    $(".NAV").show()
                    $("#home").css("border-bottom", "2px red solid")
                    $("#myresources").css("border-bottom", "none")
                    $("#upload").css("border-bottom", "none")
                } else if(type==2){
                    if (userid==0){
                        layer.open({
                            content: '你还未登录'
                            , btn: ['登录', '退出']
                            , yes: function (index, layero) {
                                //按钮【按钮一】的回调
                                location.href = "login.html";
                                layer.close(index);
                            }
                            , btn2: function (index, layero) {
                                layer.close(index);
                            }
                        });
                        return false;
                    } else {
                        $(".NAV-upload").hide()
                        $(".NAV-myresouces").show();
                        $(".NAV").hide()
                        $("#home").css("border-bottom", "none")
                        $("#myresources").css("border-bottom", "2px red solid")
                        $("#upload").css("border-bottom", "none")
                         people()
                    }

                }else if(type==3){
                    $(".NAV-upload").show();
                    $(".NAV-myresouces").hide();
                    $(".NAV").hide()
                    $("#home").css("border-bottom", "none")
                    $("#myresources").css("border-bottom", "none")
                    $("#upload").css("border-bottom", "2px red solid")
                }
            }
        }
        var tree;
        layui.use('tree', function () {
            tree = layui.tree;
        });

        // ajax获取资源方法
        function ajaxGetCategory() {
            $.ajax({
                url: "findAllforumCategory",
                type: "get",
                dataType: "json",
                success: function (jsonData) {
                    ////console.log(jsonData)
                    Category = jsonData.data;
                    insetCategory(Category);
                }
            })

        }

        // 页面渲染
        function xuran() {
            var page=1;
            var pageSize=4;
            $.ajax({
                url: "findMaxreadCountInvitation",
                type: "get",
                data:{"page":page,"pageSize":pageSize},
                dataType: "json",
                success: function (jsonData) {
                    var  data = jsonData.data;
                   ////////console.log(data)
                    var html='';
                    $.each(data,function (k,v) {
                        html=`  <tr>
                            <td style="display: flex"><div style="width: 40px;height: 20px;background-color:#FFBB66;color: white;margin-right: 10px;text-align: center">`+v.publishForm+`</div><a href="invitation_Details.html?invitationId=`+v.id+`">`+v.title+`</a></td>
                            <td>`+v.user.username+`</td>
                            <td>(`+v.readCount+`)人气</td>
                        </tr>`;
                        $(".tbHotSkill").append(html);
                    })
                }
            })
            $.ajax({
                url: "findAllInvitations",
                type: "get",
                data:{"page":page,"pageSize":pageSize},
                dataType: "json",
                success: function (jsonData) {
                    var  data = jsonData.data;
                   ////////console.log(data)
                    var html='';
                    $.each(data,function (k,v) {
                        html=`  <tr>
                            <td style="display: flex"><div style="width: 70px;height: 20px;color: #97C8F4;margin-right: 10px;text-align: center">版主推荐</div><a href="invitation_Details.html?invitationId=`+v.id+`">`+v.title+`</a></td>
                            <td>`+v.createtime+`</td>
                        </tr>`;
                        $(".tbFrumSkill").append(html);
                    })
                }
            })
            $.ajax({
                url: "findAspam",
                type: "get",
                data:{"page":page,"pageSize":pageSize},
                dataType: "json",
                success: function (jsonData) {
                    var  data = jsonData.data;
                   //////console.log(data)
                    var html='';
                    $.each(data,function (k,v) {
                        html=`  <tr>
                            <td style="display: flex"><div style="width: 70px;height: 20px;color: #D5AA83;margin-right: 10px;text-align: center">灌水乐园</div><a href="invitation_Details.html?invitationId=`+v.id+`">`+v.title+`</a></td>
                            <td>`+v.user.username+`</td>
                            <td>(`+v.readCount+`)人气</td>
                        </tr>`;
                        $(".tbHotLiving").append(html);
                    })
                }
            })
            $.ajax({
                url: "findNotice",
                type: "get",
                data:{"page":page,"pageSize":pageSize},
                dataType: "json",
                success: function (jsonData) {
                    var  data = jsonData.data;
                    //////console.log(data)
                    var html='';
                    $.each(data,function (k,v) {
                        html=`  <tr>
                            <td style="display: flex"><div style="width: 70px;height: 20px;color: #A6A9DF;margin-right: 10px;text-align: center">公告</div><a href="invitation_Details.html?invitationId=`+v.id+`">`+v.title+`</a></td>
                             <td>`+v.createtime+`</td>
                        </tr>`;
                        $(".tbForumLiving").append(html);
                    })
                }
            })

        }
        function getQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return r[2];
            return null;
        }
        function insetCategory(Category) {
            // var data=[{title:"总大类",children:Category}];
            var data = Category;
            var inst1 = tree.render({
                elem: '#treemenu'  //绑定元素
                , data: data
                , click: function (obj) {
                    ////////console.log(obj.data); //得到当前点击的节点数据
                    ////////console.log(obj.state); //得到当前节点的展开状态：open、close、normal
                    ////////console.log(obj.elem); //得到当前节点元素
                    ////////console.log(obj.data.children); //当前节点下是否有子节点
                    location.href = "forumsubdivide.html?id=" + obj.data.id + "&pid=" + obj.data.pid;
                }
            });
        }



        // 渲染二级菜单
        function getMenu() {
            // console(aaaaa)
            $.ajax({
                url: "findAllforumCategory"
                , type: "get"
                , dataType: "json"
                , success: function (jsonData) {
                    ////////////////console.log(jsonData)
                    var data = jsonData.data;
                    // if (jsonData.success == 1) {
                    //     data = jsonData.data;
                    // }
                    var html = '';
                    var html2 = '<option value="">选择大模块</option>';
                    $.each(data, function (k, v) {
                        html = `<a href="javascript:void(0)"> <input class="feilei" type="hidden" value="` + v.id + `">` + v.title + `</a>`;
                        html2 += ` <option value="` + v.id + `">` + v.title + `</option>`;
                        $("#top-rig").append(html);

                    })
                    $("#category1").html(html2);
                    form.render("select");
                }
                , error: function (res) {
                    //////////////////console.log("ajax提交错误")
                }
            })
        }

        function ajaxGetCategory2(pid) {
            // var data=getsecMenu(pid);
            $.ajax({
                url: "findforumCategoryByPid"
                , type: "GET"
                , data: {"pid": pid}
                , dataType: "json"
                // , async: false
                , success: function (jsonData) {
                    //////////////console.log(jsonData)
                    var data = jsonData.data;
                    var html = '<option value="">选择小模块</option>';
                    $.each(data, function (k, v) {
                        //////////////console.log(v)
                        html += ` <option value="` + v.id + `">` + v.title + `</option>`;

                    });
                    $("#category2").html(html);
                    form.render("select");
                }
                , error: function (res) {
                    //////////////////console.log("ajax提交错误")
                }
            })

        }




        // 编辑器

        KindEditor.ready(function (K) {
            window.editor = K.create('#editor_id', {
                items: [
                    "redo", "|", "undo", "|", "bold", "|", "italic", "|", "strikethrough", "|", "insertorderedlist", "|",
                    "insertunorderedlist", "|", "code", "|", "formatblock", "|", "table", "|", "link", "|", "unlink", "|",
                    "image", "|", "fontname", "|", "fontsize", "|", "insertfile"
                ], width: '100%',
                uploadJson: 'imgUpload',
                fileMangerJson: './kindeditor/jsp/file_manager_json.jsp',
                allowUpload: true,
                afterUpload: function (url) {
                    // ////////console.log(url)   //上传图片的路径
                }
            });

            $(".kwSumbit").click(function () {
                $("#editor_id").val(editor.html())
            })
            $("#preview").empty();
            $("#previewbtn").click(function () {
                $("#preview").html(editor.html())
                SyntaxHighlighter.highlight()

            })


        });

        layui.use(['form', 'laypage'], function () {
            laypage = layui.laypage;
            form = layui.form;
            //////////////////console.log("表单、。。。。。。")
            // form表单提交   ---  onsubmit事件阻断方案
            //此处去获取2级列表数据
            form.on('select(cate1)', function (data) {
                ////////////////console.log(data.elem); //得到select原始DOM对象
                ////////////////console.log(data.value); //得到被选中的值
                ////////////////console.log(data.othis); //得到美化后的DOM对象

                //此处去获取2级列表数据

                ajaxGetCategory2(data.value);
            });

            form.on('submit(createComment)', function (data) {
                ////////////////////console.log(data.elem) //被执行事件的元素DOM对象，一般为button对象
                ////////////////////console.log(data.form) //被执行提交的form对象，一般在存在form标签时才会返回
                //////////////////console.log(data.field) //当前容器的全部表单字段，名值对形式：{name: value}


                ajaxCreateComment(data.field)


                return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
            });

        });

        function ajaxCreateComment(data) {
            if (userid == 0) {
                layer.open({
                    content: '你还未登录'
                    , btn: ['登录', '退出']
                    , yes: function (index, layero) {
                        //按钮【按钮一】的回调
                        location.href = "login.html";
                        layer.close(index);
                    }
                    , btn2: function (index, layero) {
                        layer.close(index);
                    }
                });
                return false;
            }
            var title = data.title;
            var categoryid = data.categoryid;
            var categoryid2 = data.categoryid2;
            content=$("#editor_id").val()
            ////console.log(content)
            $.ajax({
                url: "saveInvitation",
                data: {
                    "title":title,
                    "categoryid":categoryid,
                    "categoryid2":categoryid2,
                    "content":content

                },
                type: "POST",
                dataType: "json",
                success: function (jsonData) {

                    var realFlag = jsonData.success;

                    layer.msg(realFlag == 200 ? "发帖成功" : "发帖失败");
                    if (realFlag == 200) {
                        setTimeout(function () {
                            location.href = "forumsubdivide.html?id="+categoryid2+"&pid="+categoryid;
                        }, 1 * 800)
                    }

                },
                error: function (xhr) {

                }

            })
        }

    </script>
</html>
